import{a as wn,b as xn}from"./chunk-YEKQJ4YC.mjs";var xt=wn((Xe,Ze)=>{"use strict";(function(I,e){typeof Xe=="object"&&typeof Ze<"u"?Ze.exports=e():typeof define=="function"&&define.amd?define(e):(I=typeof globalThis<"u"?globalThis:I||self,I.Fuse=e())})(Xe,(function(){"use strict";function I(i,s){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);s&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),n.push.apply(n,r)}return n}function e(i){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?I(Object(n),!0).forEach(function(r){u(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}function t(i){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t(i)}function a(i,s){if(!(i instanceof s))throw new TypeError("Cannot call a class as a function")}function o(i,s){for(var n=0;n<s.length;n++){var r=s[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,W(r.key),r)}}function c(i,s,n){return s&&o(i.prototype,s),n&&o(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}function u(i,s,n){return s=W(s),s in i?Object.defineProperty(i,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[s]=n,i}function p(i,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(s&&s.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),s&&m(i,s)}function h(i){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},h(i)}function m(i,s){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,l){return r.__proto__=l,r},m(i,s)}function w(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function L(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function T(i,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L(i)}function k(i){var s=w();return function(){var r=h(i),l;if(s){var g=h(this).constructor;l=Reflect.construct(r,arguments,g)}else l=r.apply(this,arguments);return T(this,l)}}function _(i){return F(i)||B(i)||z(i)||E()}function F(i){if(Array.isArray(i))return C(i)}function B(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function z(i,s){if(i){if(typeof i=="string")return C(i,s);var n=Object.prototype.toString.call(i).slice(8,-1);if(n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set")return Array.from(i);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(i,s)}}function C(i,s){(s==null||s>i.length)&&(s=i.length);for(var n=0,r=new Array(s);n<s;n++)r[n]=i[n];return r}function E(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P(i,s){if(typeof i!="object"||i===null)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,s||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(i)}function W(i){var s=P(i,"string");return typeof s=="symbol"?s:String(s)}function $(i){return Array.isArray?Array.isArray(i):at(i)==="[object Array]"}var Q=1/0;function K(i){if(typeof i=="string")return i;var s=i+"";return s=="0"&&1/i==-Q?"-0":s}function Pt(i){return i==null?"":K(i)}function Y(i){return typeof i=="string"}function st(i){return typeof i=="number"}function Tt(i){return i===!0||i===!1||$t(i)&&at(i)=="[object Boolean]"}function rt(i){return t(i)==="object"}function $t(i){return rt(i)&&i!==null}function q(i){return i!=null}function ze(i){return!i.trim().length}function at(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(i)}var Sn="Extended search is not available",Dt="Incorrect 'index' type",Ot=function(s){return"Invalid value for key ".concat(s)},Ft=function(s){return"Pattern length exceeds max of ".concat(s,".")},Ut=function(s){return"Missing ".concat(s," property in key")},jt=function(s){return"Property 'weight' in key '".concat(s,"' must be a positive integer")},ot=Object.prototype.hasOwnProperty,Nt=(function(){function i(s){var n=this;a(this,i),this._keys=[],this._keyMap={};var r=0;s.forEach(function(l){var g=ct(l);n._keys.push(g),n._keyMap[g.id]=g,r+=g.weight}),this._keys.forEach(function(l){l.weight/=r})}return c(i,[{key:"get",value:function(n){return this._keyMap[n]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),i})();function ct(i){var s=null,n=null,r=null,l=1,g=null;if(Y(i)||$(i))r=i,s=lt(i),n=He(i);else{if(!ot.call(i,"name"))throw new Error(Ut("name"));var f=i.name;if(r=f,ot.call(i,"weight")&&(l=i.weight,l<=0))throw new Error(jt(f));s=lt(f),n=He(f),g=i.getFn}return{path:s,id:n,weight:l,src:r,getFn:g}}function lt(i){return $(i)?i:i.split(".")}function He(i){return $(i)?i.join("."):i}function Wt(i,s){var n=[],r=!1,l=function g(f,d,y){if(q(f))if(!d[y])n.push(f);else{var b=d[y],v=f[b];if(!q(v))return;if(y===d.length-1&&(Y(v)||st(v)||Tt(v)))n.push(Pt(v));else if($(v)){r=!0;for(var M=0,x=v.length;M<x;M+=1)g(v[M],d,y+1)}else d.length&&g(v,d,y+1)}};return l(i,Y(s)?s.split("."):s,0),r?n:n[0]}var Bt={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},zt={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(s,n){return s.score===n.score?s.idx<n.idx?-1:1:s.score<n.score?-1:1}},Ht={location:0,threshold:.6,distance:100},Gt={useExtendedSearch:!1,getFn:Wt,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},A=e(e(e(e({},zt),Bt),Ht),Gt),Kt=/[^ ]+/g;function Vt(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,n=new Map,r=Math.pow(10,s);return{get:function(g){var f=g.match(Kt).length;if(n.has(f))return n.get(f);var d=1/Math.pow(f,.5*i),y=parseFloat(Math.round(d*r)/r);return n.set(f,y),y},clear:function(){n.clear()}}}var Ge=(function(){function i(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=s.getFn,r=n===void 0?A.getFn:n,l=s.fieldNormWeight,g=l===void 0?A.fieldNormWeight:l;a(this,i),this.norm=Vt(g,3),this.getFn=r,this.isCreated=!1,this.setIndexRecords()}return c(i,[{key:"setSources",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.docs=n}},{key:"setIndexRecords",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.records=n}},{key:"setKeys",value:function(){var n=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.keys=r,this._keysMap={},r.forEach(function(l,g){n._keysMap[l.id]=g})}},{key:"create",value:function(){var n=this;this.isCreated||!this.docs.length||(this.isCreated=!0,Y(this.docs[0])?this.docs.forEach(function(r,l){n._addString(r,l)}):this.docs.forEach(function(r,l){n._addObject(r,l)}),this.norm.clear())}},{key:"add",value:function(n){var r=this.size();Y(n)?this._addString(n,r):this._addObject(n,r)}},{key:"removeAt",value:function(n){this.records.splice(n,1);for(var r=n,l=this.size();r<l;r+=1)this.records[r].i-=1}},{key:"getValueForItemAtKeyId",value:function(n,r){return n[this._keysMap[r]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(n,r){if(!(!q(n)||ze(n))){var l={v:n,i:r,n:this.norm.get(n)};this.records.push(l)}}},{key:"_addObject",value:function(n,r){var l=this,g={i:r,$:{}};this.keys.forEach(function(f,d){var y=f.getFn?f.getFn(n):l.getFn(n,f.path);if(q(y)){if($(y)){for(var b=[],v=[{nestedArrIndex:-1,value:y}];v.length;){var M=v.pop(),x=M.nestedArrIndex,S=M.value;if(q(S))if(Y(S)&&!ze(S)){var R={v:S,i:x,n:l.norm.get(S)};b.push(R)}else $(S)&&S.forEach(function(D,U){v.push({nestedArrIndex:U,value:D})})}g.$[d]=b}else if(Y(y)&&!ze(y)){var O={v:y,n:l.norm.get(y)};g.$[d]=O}}}),this.records.push(g)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),i})();function ut(i,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.getFn,l=r===void 0?A.getFn:r,g=n.fieldNormWeight,f=g===void 0?A.fieldNormWeight:g,d=new Ge({getFn:l,fieldNormWeight:f});return d.setKeys(i.map(ct)),d.setSources(s),d.create(),d}function Qt(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=s.getFn,r=n===void 0?A.getFn:n,l=s.fieldNormWeight,g=l===void 0?A.fieldNormWeight:l,f=i.keys,d=i.records,y=new Ge({getFn:r,fieldNormWeight:g});return y.setKeys(f),y.setIndexRecords(d),y}function ve(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=s.errors,r=n===void 0?0:n,l=s.currentLocation,g=l===void 0?0:l,f=s.expectedLocation,d=f===void 0?0:f,y=s.distance,b=y===void 0?A.distance:y,v=s.ignoreLocation,M=v===void 0?A.ignoreLocation:v,x=r/i.length;if(M)return x;var S=Math.abs(d-g);return b?x+S/b:S?1:x}function qt(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.minMatchCharLength,n=[],r=-1,l=-1,g=0,f=i.length;g<f;g+=1){var d=i[g];d&&r===-1?r=g:!d&&r!==-1&&(l=g-1,l-r+1>=s&&n.push([r,l]),r=-1)}return i[g-1]&&g-r>=s&&n.push([r,g-1]),n}var ie=32;function Jt(i,s,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=r.location,g=l===void 0?A.location:l,f=r.distance,d=f===void 0?A.distance:f,y=r.threshold,b=y===void 0?A.threshold:y,v=r.findAllMatches,M=v===void 0?A.findAllMatches:v,x=r.minMatchCharLength,S=x===void 0?A.minMatchCharLength:x,R=r.includeMatches,O=R===void 0?A.includeMatches:R,D=r.ignoreLocation,U=D===void 0?A.ignoreLocation:D;if(s.length>ie)throw new Error(Ft(ie));for(var N=s.length,G=i.length,j=Math.max(0,Math.min(g,G)),H=b,V=j,X=S>1||O,se=X?Array(G):[],Z;(Z=i.indexOf(s,V))>-1;){var vt=ve(s,{currentLocation:Z,expectedLocation:j,distance:d,ignoreLocation:U});if(H=Math.min(vt,H),V=Z+N,X)for(var oe=0;oe<N;)se[Z+oe]=1,oe+=1}V=-1;for(var ce=[],we=1,xe=N+G,vn=1<<N-1,re=0;re<N;re+=1){for(var Me=0,ne=xe;Me<ne;){var bn=ve(s,{errors:re,currentLocation:j+ne,expectedLocation:j,distance:d,ignoreLocation:U});bn<=H?Me=ne:xe=ne,ne=Math.floor((xe-Me)/2+Me)}xe=ne;var bt=Math.max(1,j-ne+1),Je=M?G:Math.min(j+ne,G)+N,le=Array(Je+2);le[Je+1]=(1<<re)-1;for(var ee=Je;ee>=bt;ee-=1){var Ce=ee-1,kt=n[i.charAt(Ce)];if(X&&(se[Ce]=+!!kt),le[ee]=(le[ee+1]<<1|1)&kt,re&&(le[ee]|=(ce[ee+1]|ce[ee])<<1|1|ce[ee+1]),le[ee]&vn&&(we=ve(s,{errors:re,currentLocation:Ce,expectedLocation:j,distance:d,ignoreLocation:U}),we<=H)){if(H=we,V=Ce,V<=j)break;bt=Math.max(1,2*j-V)}}var kn=ve(s,{errors:re+1,currentLocation:j,expectedLocation:j,distance:d,ignoreLocation:U});if(kn>H)break;ce=le}var Ye={isMatch:V>=0,score:Math.max(.001,we)};if(X){var wt=qt(se,S);wt.length?O&&(Ye.indices=wt):Ye.isMatch=!1}return Ye}function Yt(i){for(var s={},n=0,r=i.length;n<r;n+=1){var l=i.charAt(n);s[l]=(s[l]||0)|1<<r-n-1}return s}var ht=(function(){function i(s){var n=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=r.location,g=l===void 0?A.location:l,f=r.threshold,d=f===void 0?A.threshold:f,y=r.distance,b=y===void 0?A.distance:y,v=r.includeMatches,M=v===void 0?A.includeMatches:v,x=r.findAllMatches,S=x===void 0?A.findAllMatches:x,R=r.minMatchCharLength,O=R===void 0?A.minMatchCharLength:R,D=r.isCaseSensitive,U=D===void 0?A.isCaseSensitive:D,N=r.ignoreLocation,G=N===void 0?A.ignoreLocation:N;if(a(this,i),this.options={location:g,threshold:d,distance:b,includeMatches:M,findAllMatches:S,minMatchCharLength:O,isCaseSensitive:U,ignoreLocation:G},this.pattern=U?s:s.toLowerCase(),this.chunks=[],!!this.pattern.length){var j=function(oe,ce){n.chunks.push({pattern:oe,alphabet:Yt(oe),startIndex:ce})},H=this.pattern.length;if(H>ie){for(var V=0,X=H%ie,se=H-X;V<se;)j(this.pattern.substr(V,ie),V),V+=ie;if(X){var Z=H-ie;j(this.pattern.substr(Z),Z)}}else j(this.pattern,0)}}return c(i,[{key:"searchIn",value:function(n){var r=this.options,l=r.isCaseSensitive,g=r.includeMatches;if(l||(n=n.toLowerCase()),this.pattern===n){var f={isMatch:!0,score:0};return g&&(f.indices=[[0,n.length-1]]),f}var d=this.options,y=d.location,b=d.distance,v=d.threshold,M=d.findAllMatches,x=d.minMatchCharLength,S=d.ignoreLocation,R=[],O=0,D=!1;this.chunks.forEach(function(N){var G=N.pattern,j=N.alphabet,H=N.startIndex,V=Jt(n,G,j,{location:y+H,distance:b,threshold:v,findAllMatches:M,minMatchCharLength:x,includeMatches:g,ignoreLocation:S}),X=V.isMatch,se=V.score,Z=V.indices;X&&(D=!0),O+=se,X&&Z&&(R=[].concat(_(R),_(Z)))});var U={isMatch:D,score:D?O/this.chunks.length:1};return D&&g&&(U.indices=R),U}}]),i})(),te=(function(){function i(s){a(this,i),this.pattern=s}return c(i,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(n){return gt(n,this.multiRegex)}},{key:"isSingleMatch",value:function(n){return gt(n,this.singleRegex)}}]),i})();function gt(i,s){var n=i.match(s);return n?n[1]:null}var Xt=(function(i){p(n,i);var s=k(n);function n(r){return a(this,n),s.call(this,r)}return c(n,[{key:"search",value:function(l){var g=l===this.pattern;return{isMatch:g,score:g?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),n})(te),Zt=(function(i){p(n,i);var s=k(n);function n(r){return a(this,n),s.call(this,r)}return c(n,[{key:"search",value:function(l){var g=l.indexOf(this.pattern),f=g===-1;return{isMatch:f,score:f?0:1,indices:[0,l.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),n})(te),en=(function(i){p(n,i);var s=k(n);function n(r){return a(this,n),s.call(this,r)}return c(n,[{key:"search",value:function(l){var g=l.startsWith(this.pattern);return{isMatch:g,score:g?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),n})(te),tn=(function(i){p(n,i);var s=k(n);function n(r){return a(this,n),s.call(this,r)}return c(n,[{key:"search",value:function(l){var g=!l.startsWith(this.pattern);return{isMatch:g,score:g?0:1,indices:[0,l.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),n})(te),nn=(function(i){p(n,i);var s=k(n);function n(r){return a(this,n),s.call(this,r)}return c(n,[{key:"search",value:function(l){var g=l.endsWith(this.pattern);return{isMatch:g,score:g?0:1,indices:[l.length-this.pattern.length,l.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),n})(te),sn=(function(i){p(n,i);var s=k(n);function n(r){return a(this,n),s.call(this,r)}return c(n,[{key:"search",value:function(l){var g=!l.endsWith(this.pattern);return{isMatch:g,score:g?0:1,indices:[0,l.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),n})(te),dt=(function(i){p(n,i);var s=k(n);function n(r){var l,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=g.location,d=f===void 0?A.location:f,y=g.threshold,b=y===void 0?A.threshold:y,v=g.distance,M=v===void 0?A.distance:v,x=g.includeMatches,S=x===void 0?A.includeMatches:x,R=g.findAllMatches,O=R===void 0?A.findAllMatches:R,D=g.minMatchCharLength,U=D===void 0?A.minMatchCharLength:D,N=g.isCaseSensitive,G=N===void 0?A.isCaseSensitive:N,j=g.ignoreLocation,H=j===void 0?A.ignoreLocation:j;return a(this,n),l=s.call(this,r),l._bitapSearch=new ht(r,{location:d,threshold:b,distance:M,includeMatches:S,findAllMatches:O,minMatchCharLength:U,isCaseSensitive:G,ignoreLocation:H}),l}return c(n,[{key:"search",value:function(l){return this._bitapSearch.searchIn(l)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),n})(te),ft=(function(i){p(n,i);var s=k(n);function n(r){return a(this,n),s.call(this,r)}return c(n,[{key:"search",value:function(l){for(var g=0,f,d=[],y=this.pattern.length;(f=l.indexOf(this.pattern,g))>-1;)g=f+y,d.push([f,g-1]);var b=!!d.length;return{isMatch:b,score:b?0:1,indices:d}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),n})(te),Ke=[Xt,ft,en,tn,sn,nn,Zt,dt],pt=Ke.length,rn=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,an="|";function on(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i.split(an).map(function(n){for(var r=n.trim().split(rn).filter(function(R){return R&&!!R.trim()}),l=[],g=0,f=r.length;g<f;g+=1){for(var d=r[g],y=!1,b=-1;!y&&++b<pt;){var v=Ke[b],M=v.isMultiMatch(d);M&&(l.push(new v(M,s)),y=!0)}if(!y)for(b=-1;++b<pt;){var x=Ke[b],S=x.isSingleMatch(d);if(S){l.push(new x(S,s));break}}}return l})}var cn=new Set([dt.type,ft.type]),ln=(function(){function i(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.isCaseSensitive,l=r===void 0?A.isCaseSensitive:r,g=n.includeMatches,f=g===void 0?A.includeMatches:g,d=n.minMatchCharLength,y=d===void 0?A.minMatchCharLength:d,b=n.ignoreLocation,v=b===void 0?A.ignoreLocation:b,M=n.findAllMatches,x=M===void 0?A.findAllMatches:M,S=n.location,R=S===void 0?A.location:S,O=n.threshold,D=O===void 0?A.threshold:O,U=n.distance,N=U===void 0?A.distance:U;a(this,i),this.query=null,this.options={isCaseSensitive:l,includeMatches:f,minMatchCharLength:y,findAllMatches:x,ignoreLocation:v,location:R,threshold:D,distance:N},this.pattern=l?s:s.toLowerCase(),this.query=on(this.pattern,this.options)}return c(i,[{key:"searchIn",value:function(n){var r=this.query;if(!r)return{isMatch:!1,score:1};var l=this.options,g=l.includeMatches,f=l.isCaseSensitive;n=f?n:n.toLowerCase();for(var d=0,y=[],b=0,v=0,M=r.length;v<M;v+=1){var x=r[v];y.length=0,d=0;for(var S=0,R=x.length;S<R;S+=1){var O=x[S],D=O.search(n),U=D.isMatch,N=D.indices,G=D.score;if(U){if(d+=1,b+=G,g){var j=O.constructor.type;cn.has(j)?y=[].concat(_(y),_(N)):y.push(N)}}else{b=0,d=0,y.length=0;break}}if(d){var H={isMatch:!0,score:b/d};return g&&(H.indices=y),H}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(n,r){return r.useExtendedSearch}}]),i})(),be=[];function un(){be.push.apply(be,arguments)}function Ve(i,s){for(var n=0,r=be.length;n<r;n+=1){var l=be[n];if(l.condition(i,s))return new l(i,s)}return new ht(i,s)}var ke={AND:"$and",OR:"$or"},Qe={PATH:"$path",PATTERN:"$val"},qe=function(s){return!!(s[ke.AND]||s[ke.OR])},hn=function(s){return!!s[Qe.PATH]},gn=function(s){return!$(s)&&rt(s)&&!qe(s)},mt=function(s){return u({},ke.AND,Object.keys(s).map(function(n){return u({},n,s[n])}))};function yt(i,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.auto,l=r===void 0?!0:r,g=function f(d){var y=Object.keys(d),b=hn(d);if(!b&&y.length>1&&!qe(d))return f(mt(d));if(gn(d)){var v=b?d[Qe.PATH]:y[0],M=b?d[Qe.PATTERN]:d[v];if(!Y(M))throw new Error(Ot(v));var x={keyId:He(v),pattern:M};return l&&(x.searcher=Ve(M,s)),x}var S={children:[],operator:y[0]};return y.forEach(function(R){var O=d[R];$(O)&&O.forEach(function(D){S.children.push(f(D))})}),S};return qe(i)||(i=mt(i)),g(i)}function dn(i,s){var n=s.ignoreFieldNorm,r=n===void 0?A.ignoreFieldNorm:n;i.forEach(function(l){var g=1;l.matches.forEach(function(f){var d=f.key,y=f.norm,b=f.score,v=d?d.weight:null;g*=Math.pow(b===0&&v?Number.EPSILON:b,(v||1)*(r?1:y))}),l.score=g})}function fn(i,s){var n=i.matches;s.matches=[],q(n)&&n.forEach(function(r){if(!(!q(r.indices)||!r.indices.length)){var l=r.indices,g=r.value,f={indices:l,value:g};r.key&&(f.key=r.key.src),r.idx>-1&&(f.refIndex=r.idx),s.matches.push(f)}})}function pn(i,s){s.score=i.score}function mn(i,s){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.includeMatches,l=r===void 0?A.includeMatches:r,g=n.includeScore,f=g===void 0?A.includeScore:g,d=[];return l&&d.push(fn),f&&d.push(pn),i.map(function(y){var b=y.idx,v={item:s[b],refIndex:b};return d.length&&d.forEach(function(M){M(y,v)}),v})}var ae=(function(){function i(s){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;a(this,i),this.options=e(e({},A),n),this.options.useExtendedSearch,this._keyStore=new Nt(this.options.keys),this.setCollection(s,r)}return c(i,[{key:"setCollection",value:function(n,r){if(this._docs=n,r&&!(r instanceof Ge))throw new Error(Dt);this._myIndex=r||ut(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}},{key:"add",value:function(n){q(n)&&(this._docs.push(n),this._myIndex.add(n))}},{key:"remove",value:function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){return!1},r=[],l=0,g=this._docs.length;l<g;l+=1){var f=this._docs[l];n(f,l)&&(this.removeAt(l),l-=1,g-=1,r.push(f))}return r}},{key:"removeAt",value:function(n){this._docs.splice(n,1),this._myIndex.removeAt(n)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=r.limit,g=l===void 0?-1:l,f=this.options,d=f.includeMatches,y=f.includeScore,b=f.shouldSort,v=f.sortFn,M=f.ignoreFieldNorm,x=Y(n)?Y(this._docs[0])?this._searchStringList(n):this._searchObjectList(n):this._searchLogical(n);return dn(x,{ignoreFieldNorm:M}),b&&x.sort(v),st(g)&&g>-1&&(x=x.slice(0,g)),mn(x,this._docs,{includeMatches:d,includeScore:y})}},{key:"_searchStringList",value:function(n){var r=Ve(n,this.options),l=this._myIndex.records,g=[];return l.forEach(function(f){var d=f.v,y=f.i,b=f.n;if(q(d)){var v=r.searchIn(d),M=v.isMatch,x=v.score,S=v.indices;M&&g.push({item:d,idx:y,matches:[{score:x,value:d,norm:b,indices:S}]})}}),g}},{key:"_searchLogical",value:function(n){var r=this,l=yt(n,this.options),g=function b(v,M,x){if(!v.children){var S=v.keyId,R=v.searcher,O=r._findMatches({key:r._keyStore.get(S),value:r._myIndex.getValueForItemAtKeyId(M,S),searcher:R});return O&&O.length?[{idx:x,item:M,matches:O}]:[]}for(var D=[],U=0,N=v.children.length;U<N;U+=1){var G=v.children[U],j=b(G,M,x);if(j.length)D.push.apply(D,_(j));else if(v.operator===ke.AND)return[]}return D},f=this._myIndex.records,d={},y=[];return f.forEach(function(b){var v=b.$,M=b.i;if(q(v)){var x=g(l,v,M);x.length&&(d[M]||(d[M]={idx:M,item:v,matches:[]},y.push(d[M])),x.forEach(function(S){var R,O=S.matches;(R=d[M].matches).push.apply(R,_(O))}))}}),y}},{key:"_searchObjectList",value:function(n){var r=this,l=Ve(n,this.options),g=this._myIndex,f=g.keys,d=g.records,y=[];return d.forEach(function(b){var v=b.$,M=b.i;if(q(v)){var x=[];f.forEach(function(S,R){x.push.apply(x,_(r._findMatches({key:S,value:v[R],searcher:l})))}),x.length&&y.push({idx:M,item:v,matches:x})}}),y}},{key:"_findMatches",value:function(n){var r=n.key,l=n.value,g=n.searcher;if(!q(l))return[];var f=[];if($(l))l.forEach(function(S){var R=S.v,O=S.i,D=S.n;if(q(R)){var U=g.searchIn(R),N=U.isMatch,G=U.score,j=U.indices;N&&f.push({score:G,key:r,value:R,idx:O,norm:D,indices:j})}});else{var d=l.v,y=l.n,b=g.searchIn(d),v=b.isMatch,M=b.score,x=b.indices;v&&f.push({score:M,key:r,value:d,norm:y,indices:x})}return f}}]),i})();ae.version="7.0.0",ae.createIndex=ut,ae.parseIndex=Qt,ae.config=A,ae.parseQuery=yt,un(ln);var yn=ae;return yn}))});var Rt=xn(xt());var et={bagaimana:["bgmn","gimana","pripun","how"],dimana:["dimn","dmn","where"],kapan:["kpn","when"],siapa:["sp","sopo","who"],apa:["opo","what"],kenapa:["knp","mengapa","napa","why"],harga:["hargany","hargax","price"],diskon:["disk","potongan","discount"],promo:["promosi","pro"],gratis:["free","cuma-cuma"],beli:["order","pesen"]},Mt=["dan","atau","tapi","namun","dengan","untuk","dari","yang","itu","ini","ke","di","ada","adalah","bagi","pada","saya","anda","kamu","kami","kita","mereka","sebuah","sudah","telah","akan","ingin","mau","bisa","dapat","boleh","harus","perlu","juga","saja","pun","lah","kah","nya","apa","apaan","bagaimana","gimana","siapa","kapan","dimana","kenapa","mengapa","berapa","mana","setiap","sangat","sekali","tentang","yakni","yaitu","kok","deh","dong","sih","tah","punya","oleh","olehnya"],Ct={beli:["order","pesan","checkout","booking","ambil","dapatkan"],harga:["biaya","cost","budget","tarif","nilai","price"],promo:["diskon","discount","sale","hemat","off","potongan"],fitur:["keunggulan","kelebihan","fasilitas","spesifikasi","detail"],kontak:["hubungi","whatsapp","wa","email","alamat","telepon"],murah:["terjangkau","ekonomis","budget","grosir"],premium:["eksklusif","mewah","lux","v VIP"],syarat:["ketentuan","kondisi","requirement"]},Ae={beli:["beli","pesan","ambil","order","checkout","booking","buy","purchase","get","mau","bisa dapet","dapetin"],harga:["harga","biaya","price","budget","bayar","cicilan","dp","murah","cost","payment","cheap","tarif","berapa","nominal","berapaan","murmer","mahal","terjangkau"],promo:["promo","diskon","discount","sale","hemat","bonus","voucher","off","potongan","cashback","gratis","free"],fitur:["fitur","fiturnya","spesifikasi","spek","kelebihan","keunggulan","fasilitas","detail","benefit","apa saja","termasuk"],stok:["stok","stock","tersedia","ready","available","kosong","habis","ada","masih ada"],lokasi:["lokasi","alamat","outlet","cabang","toko","kantor","tempat","dimana","posisi","maps"],pengiriman:["kirim","ongkir","delivery","pengiriman","estimasi","sampai","ekspedisi","kurir","jne","jnt","sicepat","anteraja","gosend","grab"],garansi:["garansi","warranty","jaminan","klaim","retur","return","tukar","refund","komplain"]},At={greeting:["halo","halo","hi","helo","hey","pagi","siang","sore","malam","assalamualaikum","permisi","hello"],thanks:["terima kasih","thanks","tq","syukron","makasih","oke","sip","mantap"]},St=["kontak","contact","whatsapp","wa","email","telepon","phone","call","hubungi","tanya admin","chat admin","nanya"],he=["harganya","berapa","fitur","warna","ukuran","ready","stok","fasilitas","promonya"],_t={title:"Produk",price:"Harga",recommendation:"Pilihan Terbaik",bestChoice:"Rekomendasi Utama",reasons:"Mengapa ini cocok untuk Anda?",noProducts:"Maaf, saya tidak menemukan produk yang pas untuk dibandingkan.",vsLabel:"vs",discount:"Hemat {discount}% dari harga normal!",cheapest:"Paling ekonomis di kelasnya",mostFeatures:"Fitur paling lengkap & canggih",warranty:"Jaminan Garansi: {warranty}",teamRecommendation:"Sangat direkomendasikan oleh tim kami"},Et={harga:/(?:harga|price|biaya)[:\s]*(?:rp\.?|idr)?\s*([\d.,]+)/i,kapasitas:/(?:kapasitas|capacity)[:\s]*([\d.,]+\s*(?:gb|mb|tb|liter|kg|gram|ml|l|g))/i,kecepatan:/(?:kecepatan|speed)[:\s]*([\d.,]+\s*(?:mbps|gbps|rpm|mhz|ghz))/i,garansi:/(?:garansi|warranty)[:\s]*([\d]+\s*(?:tahun|bulan|year|month|hari|day)s?)/i,rating:/(?:rating|bintang|star)[:\s]*([\d.,]+)/i,material:/(?:bahan|material)[:\s]*([a-zA-Z\s]+?)(?:\.|,|$)/i,warna:/(?:warna|color|colour)[:\s]*([a-zA-Z\s]+?)(?:\.|,|$)/i,ukuran:/(?:ukuran|size|dimensi|dimension)[:\s]*([\d.,x\s]+(?:cm|mm|m|inch)?)/i},It={harga:"Harga",harga_promo:"Harga Promo",kapasitas:"Kapasitas",kecepatan:"Kecepatan",garansi:"Garansi",rating:"Rating",material:"Material",warna:"Warna",ukuran:"Ukuran",fitur:"Fitur Utama",badge:"Status",direkomendasikan:"Rekomendasi"},J={locale:"id-ID",currencySymbol:"Rp",answerTemplates:{price:["Tentu! Harga {title} saat ini adalah {currency} {price}. Menarik banget kan?","Untuk {title}, harganya cuma {currency} {price} lho kak.","Cuma {currency} {price} aja buat bawa pulang {title}.","Saat ini {title} dibanderol {currency} {price}. Worth it banget!"],features:["Ini dia keunggulan {title}: {features}. Gimana, sesuai kebutuhan?","{title} punya fitur keren: {features}. Tertarik?","Spesifikasi {title} meliputi {features}. Mantap kan?"],noResults:["Aduh, maaf banget ya, saya belum nemu info soal itu. Mungkin bisa coba kata kunci lain?","Wah saya belum punya data soal itu kak. Coba tanya yang lain ya?","Mohon maaf, informasi tersebut belum tersedia di database saya."]},sentimentPrefixes:{negative:["Mohon maaf atas ketidaknyamanannya kak.","Aduh, maaf banget ya kak.","Saya mengerti kendala Kakak.","Maaf ya kak, saya usahakan bantu."],positive:["Wah, senang mendengarnya! ","Terima kasih banyak kak! ","Mantap kak! "]},resultLimit:5,subSearchJoiner:". Dan juga, ",fallbackResponses:{chat_greeting:"Halo! Senang sekali Anda mampir. Ada yang bisa saya bantu cari hari ini? Tanya soal paket atau promo juga boleh lho!",chat_thanks:"Sama-sama! Senang banget bisa bantu. Kalau ada yang bingung lagi, tanya aja ya!",chat_contact:"Tentu! Anda bisa langsung ngobrol sama tim admin kami lewat WhatsApp. Mau saya sambungkan sekarang?"},crawlerCategory:"Page"},Lt=/\s+(?:trus|lalu|kemudian|dan|and|then)\s+|[?!;]|,/gi;var tt={PRICE:"harga",PRICE_PROMO:"harga_promo",BADGE:"badge",RECOMMENDED:"direkomendasikan",FEATURES:"fitur",RATING:"rating",WARRANTY:"garansi"};var ge=class{constructor(e={}){this.handlers=new Set;this.metrics=new Map;this.config={enabled:e.enabled??!0,logger:e.logger??console.log,sampleRate:e.sampleRate??1}}onEvent(e){return this.handlers.add(e),()=>this.handlers.delete(e)}track(e,t,a,o){if(!this.config.enabled||Math.random()>this.config.sampleRate)return;let c={type:e,payload:t,timestamp:Date.now(),sessionId:a,metadata:o};this.updateInternalMetrics(e),setTimeout(()=>{try{this.handlers.forEach(u=>u(c))}catch{this.config.logger("Analytics handler error","error")}},0)}getMetrics(){return Object.fromEntries(this.metrics)}resetMetrics(){this.metrics.clear()}updateInternalMetrics(e){let t=this.metrics.get(e)||0;this.metrics.set(e,t+1)}},En=new ge;var Se=class{constructor(){this.requestMiddlewares=[];this.responseMiddlewares=[]}useRequest(e){this.requestMiddlewares.push(e)}useResponse(e){this.responseMiddlewares.push(e)}async executeRequest(e,t){let a={query:e,originalQuery:e,context:t||{},metadata:{},stop:!1},o=async c=>{if(c>=this.requestMiddlewares.length||a.stop)return;let u=this.requestMiddlewares[c];try{await u(a,async()=>{await o(c+1)})}catch(p){console.error(`Middleware Error (Request #${c}):`,p),await o(c+1)}};return await o(0),a}async executeResponse(e,t){let a=async o=>{if(o>=this.responseMiddlewares.length)return;let c=this.responseMiddlewares[o];try{await c(e,t,async()=>{await a(o+1)})}catch(u){console.error(`Middleware Error (Response #${o}):`,u),await a(o+1)}};return await a(0),e}};var Mn=[{triggerCategory:"Laptop",suggestCategory:"Aksesoris",messageTemplate:"Biar makin lengkap, sekalian tambah aksesori ini kak?"},{triggerCategory:"HP",suggestCategory:"Casing",messageTemplate:"Lindungi HP baru kakak dengan casing premium ini yuk!"},{triggerCategory:"Fashion",suggestCategory:"Tas",messageTemplate:"Outfit ini bakal makin kece kalau dipadukan sama tas ini."}],_e=class{constructor(e={}){this.config={enableFomo:e.enableFomo??!0,enableSocialProof:e.enableSocialProof??!0,enableCrossSell:e.enableCrossSell??!0,fomoThreshold:e.fomoThreshold??10,crossSellRules:e.crossSellRules??Mn}}getFomoSignal(e){if(!this.config.enableFomo)return null;let t=e.title.length%15+1;if(t<5)return`\u{1F525} Stok menipis! Sisa ${t} unit lagi.`;if(t<this.config.fomoThreshold)return"\u26A1 Laris manis! Banyak yang cari produk ini.";let a=new Date().getHours();return a>=18&&a<=23?"\u23F0 Promo malam berakhir sebentar lagi!":null}getSocialProof(e){if(!this.config.enableSocialProof)return null;let t=e.title.length*3%50+5,o=[`\u{1F440} ${e.title.length*7%20+2} orang sedang melihat produk ini.`,`\u2705 Terjual ${t} unit minggu ini.`,"\u2B50 Favorit pelanggan bulan ini.","top_rated"in e?"\u{1F3C6} Produk rating tertinggi!":null],c=new Date().getDate()%o.length;return o[c]}getCrossSell(e,t){if(!this.config.enableCrossSell)return[];let a=this.config.crossSellRules.find(c=>c.triggerCategory.toLowerCase()===e.category?.toLowerCase());return a?t.filter(c=>c.category?.toLowerCase()===a.suggestCategory.toLowerCase()&&c.title!==e.title).slice(0,2):[]}getPersuasiveCTA(e){switch(e){case"hot":return"Amankan sekarang sebelum kehabisan! Stok rebutan lho kak.";case"warm":return"Mumpung masih ada promo, mau saya bantu pesankan?";default:return"Boleh dilihat-lihat dulu kak, jamin gak nyesel."}}getClosingQuestion(){let e=["Mau saya bantu proses pesenannya kak?","Gimana kak, tertarik buat ambil promo hari ini?","Mau langsung amankan stoknya sekarang?","Detailnya sudah jelas kak? Mau sekalian saya buatkan invoicenya?","Ada lagi yang bikin kakak ragu? Saya bantu jelasin ya."];return e[Math.floor(Math.random()*e.length)]}getObjectionPrefix(){let e=["Saya benar-benar mengerti kekhawatiran Kakak.","Wajar kok kak kalau kakak tanya soal itu. Begini penjelasannya...","Tenang kak, banyak juga yang awalnya ragu tapi akhirnya puas banget.","Kritik kakak jadi masukan berharga buat kami.","Maaf banget ya kak kalau ada yang kurang pas."];return e[Math.floor(Math.random()*e.length)]}};var nt=class{constructor(e,t="gpt-3.5-turbo",a="https://api.openai.com/v1/chat/completions"){this.name="openai";this.apiKey=e,this.model=t,this.apiUrl=a}async generateResponse(e,t){if(!this.apiKey)return"Maaf, saya belum dikonfigurasi sepenuhnya (Missing API Key).";try{let o=await(await fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:[{role:"system",content:t?.systemPrompt||"You are a helpful sales assistant."},{role:"user",content:e}],max_tokens:150})})).json();if(o.error)throw new Error(o.error.message);return o.choices[0]?.message?.content||"Maaf, saya sedang tidak bisa berpikir sekarang."}catch(a){return console.error("LLM Error:",a),"Maaf, koneksi ke otak kedua saya sedang gangguan."}}},Ee=class{constructor(e={}){this.provider=null;this.provider=e.provider||null,this.systemPrompt=e.systemPrompt||"Anda adalah asisten sales yang ramah, membantu, dan persuasif. Jawab dalam Bahasa Indonesia.",!this.provider&&e.apiKey&&(this.provider=new nt(e.apiKey,e.model,e.apiUrl))}async fallback(e,t){return this.provider?await this.provider.generateResponse(e,{systemPrompt:this.systemPrompt,...t}):null}setProvider(e){this.provider=e}};var Cn={"sales.price":["berapa harganya","price list","murah gak","harganya berapa","cek harga"],"sales.order":["cara beli","mau order","pesan sekarang","checkout","beli dong"],"sales.promo":["ada diskon","kode promo","voucher","potongan harga"],"support.complaint":["barang rusak","kecewa","komplain","belum sampai","lama banget"],"support.help":["bantuan","customer service","admin","tanya dong"],greeting:["halo","hi","selamat pagi","siang","malam"]},Ie=class{constructor(e={}){this.wordCounts=new Map;this.labelCounts=new Map;this.vocab=new Set;this.totalDocuments=0;this.config=e,this.trainData(e.trainingData||Cn)}trainData(e){for(let[t,a]of Object.entries(e))a.forEach(o=>this.train(o,t))}train(e,t){let a=this.tokenize(e);this.wordCounts.has(t)||this.wordCounts.set(t,new Map);let o=this.wordCounts.get(t);a.forEach(c=>{o.set(c,(o.get(c)||0)+1),this.vocab.add(c)}),this.labelCounts.set(t,(this.labelCounts.get(t)||0)+1),this.totalDocuments++}classify(e){let t=this.tokenize(e),a={},o=-1/0,c="unknown";this.labelCounts.forEach((p,h)=>{a[h]=this.calculateLogProbability(t,h),a[h]>o&&(o=a[h],c=h)});let u=this.calculateConfidence(a);return{intent:c,confidence:u,allScores:a}}calculateLogProbability(e,t){let a=this.labelCounts.get(t)||0,o=Math.log(a/this.totalDocuments),c=this.wordCounts.get(t),u=Array.from(c.values()).reduce((h,m)=>h+m,0),p=this.vocab.size;return e.forEach(h=>{let w=((c.get(h)||0)+1)/(u+p);o+=Math.log(w)}),o}calculateConfidence(e){let t=Object.values(e);if(t.length===0)return 0;let a=Math.max(...t),o=t.reduce((u,p)=>u+Math.exp(p-a),0),c=t.map(u=>Math.exp(u-a)/o);return Math.max(...c)}tokenize(e){return e.toLowerCase().replace(/[^\w\s]/g,"").split(/\s+/).filter(t=>t.length>2)}};var Le=class{constructor(e={}){this.config=e,this.nlp=new Ie(e.nlp||{})}detect(e,t,a){let o=this.nlp.classify(e);if(o&&o.confidence>(this.config.threshold||.7))return o.intent;if([...St,...this.config.contactTriggers||[]].some(h=>a.includes(h)||t.includes(h)))return"chat_contact";let u={...At,...this.config.conversationTriggers||{}};for(let[h,m]of Object.entries(u))if(m.some(w=>a.includes(w)||t.includes(w)))return`chat_${h}`;let p={...Ae,...this.config.salesTriggers||{}};for(let[h,m]of Object.entries(p))if(m.some(w=>a.includes(w)||t.includes(w)))return`sales_${h}`;return o&&o.confidence>.6?o.intent:"fuzzy"}train(e,t){this.nlp.train(e,t)}};var de={positiveWords:{"luar biasa":3,"sangat bagus":3,mantap:3,keren:3,wow:3,sempurna:3,hebat:3,amazing:3,excellent:3,love:3,"puas banget":3,super:3,top:3,best:3,terbaik:3,bagus:2,baik:2,senang:2,suka:2,oke:2,ok:2,puas:2,recommended:2,rekomen:2,worth:2,nice:2,good:2,great:2,happy:2,"terima kasih":2,makasih:2,thanks:2,bersyukur:2,alhamdulillah:2,syukur:2,membantu:2,helpful:2,ramah:2,cepat:2,murah:2,boleh:1,lumayan:1,cukup:1,standar:1,fair:1,sip:1,siap:1,yes:1,setuju:1,menarik:1,enak:1,nyaman:1,aman:1,lancar:1},negativeWords:{"kecewa berat":3,"sangat kecewa":3,parah:3,sampah:3,terrible:3,awful:3,worst:3,terburuk:3,bohong:3,nipu:3,penipu:3,scam:3,fraud:3,bangkrut:3,"rugi besar":3,"no response":3,"tidak merespon":3,kecewa:2,marah:2,kesal:2,buruk:2,jelek:2,lambat:2,lama:2,gagal:2,rusak:2,error:2,"tidak bisa":2,gabisa:2,"gak bisa":2,susah:2,sulit:2,ribet:2,repot:2,mahal:2,overpriced:2,kemahalan:2,komplain:2,complaint:2,bad:2,poor:2,masalah:2,problem:2,issue:2,keluhan:2,protes:2,benci:2,kurang:1,"tidak puas":1,biasa:1,"so-so":1,meh:1,belum:1,tunggu:1,waiting:1,pending:1,delay:1,bingung:1,confused:1,"tidak jelas":1,unclear:1},intensifiers:{sangat:1.5,banget:1.5,sekali:1.5,bgt:1.5,bngt:1.5,amat:1.5,super:1.5,really:1.5,very:1.5,totally:1.5,parah:1.3,gila:1.3,pol:1.3,ekstrim:1.3,agak:.7,sedikit:.7,dikit:.7,lumayan:.8},negators:["tidak","bukan","tak","gak","ga","nggak","kagak","belum","jangan","tanpa","no","not","never","none"],urgencyWords:["urgent","darurat","segera","asap","sekarang","cepat","buru-buru","deadline","penting","emergency","tolong","help","bantuan","sos"]},fe=class fe{constructor(e){this.config={positiveWords:{...de.positiveWords,...e?.positiveWords||{}},negativeWords:{...de.negativeWords,...e?.negativeWords||{}},intensifiers:{...de.intensifiers,...e?.intensifiers||{}},negators:[...de.negators||[],...e?.negators||[]],urgencyWords:[...de.urgencyWords||[],...e?.urgencyWords||[]]}}analyze(e){if(!e||typeof e!="string")return fe.getEmptyResult();let t=e.toLowerCase(),a=t.split(/\s+/),o=0,c=0,u=1,p=[],h=[],m=[],w=this.config.urgencyWords.some(C=>t.includes(C))||(e.match(/!/g)||[]).length>=2,L=(e.match(/!/g)||[]).length;L>0&&(u*=1+L*.15),(e.match(/[A-Z]{2,}/g)||[]).length>0&&(u*=1.2),e.match(/(.)\1{2,}/g)&&(u*=1.3);let T=!1;for(let C=0;C<a.length;C++){let E=a[C],P=a[C+1]||"",W=E+" "+P;if(this.config.negators.includes(E)){T=!0;continue}if(this.config.intensifiers[E]){u*=this.config.intensifiers[E],m.push(E);continue}let $=0,Q=!1,K="";this.config.positiveWords[W]?($=this.config.positiveWords[W],Q=!0,K=W,C++):this.config.negativeWords[W]?($=this.config.negativeWords[W],Q=!1,K=W,C++):this.config.positiveWords[E]?($=this.config.positiveWords[E],Q=!0,K=E):this.config.negativeWords[E]&&($=this.config.negativeWords[E],Q=!1,K=E),K&&(T?(Q?(c+=$,h.push(`not ${K}`)):(o+=$,p.push(`not ${K}`)),T=!1):Q?(o+=$,p.push(K)):(c+=$,h.push(K)))}let k=(o-c)*u,_=Math.max(-100,Math.min(100,k*10)),F="neutral";_>10?F="positive":_<-10&&(F="negative");let B="low",z=Math.abs(_);return z>40?B="high":z>20&&(B="medium"),{score:Math.round(_),label:F,isUrgent:w,intensity:B,details:{positiveWords:p,negativeWords:h,intensifiers:m}}}static analyze(e){return this.defaultInstance.analyze(e)}static isNegative(e){return this.defaultInstance.analyze(e).label==="negative"}static isPositive(e){return this.defaultInstance.analyze(e).label==="positive"}static isUrgent(e){return this.defaultInstance.analyze(e).isUrgent}static getPriority(e){let t=this.defaultInstance.analyze(e);return t.isUrgent&&t.label==="negative"||t.label==="negative"&&t.intensity==="high"?5:t.isUrgent||t.label==="negative"&&t.intensity==="medium"?4:t.label==="negative"?3:t.label==="neutral"?2:1}static getEmptyResult(){return{score:0,label:"neutral",isUrgent:!1,intensity:"low",details:{positiveWords:[],negativeWords:[],intensifiers:[]}}}};fe.defaultInstance=new fe;var Re=fe;var Pe=class{constructor(e={}){this.state={lastCategory:null,lastItemId:null,detectedEntities:new Set,interactionCount:0,lockedEntityId:null,lastActive:0};let t=Array.isArray(e)?{referenceTriggers:e}:e;this.config={referenceTriggers:he,ttl:300*1e3,maxInteractions:20,...t},this.reset()}resolveAnaphora(e){if(this.prune(),!e||e.length>=25)return e;let t=e.toLowerCase();if((this.config.referenceTriggers||he).some(c=>t.includes(c.toLowerCase()))&&(this.state.lockedEntityId||this.state.lastItemId)){let c=this.state.lockedEntityId||this.state.lastItemId;return`${e} ${c}`}return e}update(e){if(this.state.interactionCount++,this.state.lastActive=Date.now(),this.state.interactionCount>(this.config.maxInteractions||20)){this.reset();return}if(e.results&&e.results.length>0){let t=e.results[0];this.state.lastCategory=t.category,this.state.lastItemId=t.title,e.confidence>80?this.state.lockedEntityId=t.title:e.confidence<30&&(this.state.lockedEntityId=null)}e.entities&&Object.keys(e.entities).forEach(t=>{e.entities[t]&&this.state.detectedEntities.add(t)})}prune(){Date.now()-this.state.lastActive>(this.config.ttl||3e5)&&this.reset()}getState(){return this.prune(),{...this.state}}reset(){this.state={lastCategory:null,lastItemId:null,detectedEntities:new Set,interactionCount:0,lockedEntityId:null,lastActive:Date.now()}}};function pe(I,e="Rp",t="id-ID"){if(t==="id-ID"&&I>=1e6)return`${e} ${(I/1e6).toFixed(1)}Jt`;try{return new Intl.NumberFormat(t,{style:"currency",currencyDisplay:"symbol",currency:"IDR"}).format(I).replace("IDR",e)}catch{return`${e} ${I.toLocaleString(t)}`}}var Te=class{constructor(e={},t){this.config=e,this.salesPsychology=t}compose(e,t,a,o){let c=e.results,u={...J.answerTemplates,...this.config.answerTemplates},p=e.sentiment,h=c[0]?.answer||"";if(c.length>0){let m=c[0],w=o(m);if(t==="sales_harga"){let L=m.sale_price||m.price_numeric;L&&(h=this.getTemplate(u.price).replace("{title}",m.title).replace("{currency}","").replace("{price}",pe(L,this.config.currencySymbol||J.currencySymbol,this.config.locale||J.locale)).replace("  "," "))}else if(t==="sales_fitur"||t==="fuzzy_fitur"){let L={...tt,...this.config.schema},T=w[L.FEATURES]||m.description;h=this.getTemplate(u.features).replace("{title}",m.title).replace("{features}",T)}else h||(h=this.assembleDescription(m,w))}if(!h){let m={...J.fallbackResponses,...this.config.fallbackIntentResponses};t==="chat_greeting"?h=m.chat_greeting:t==="chat_thanks"?h=m.chat_thanks:t==="chat_contact"?h=m.chat_contact:!a&&c.length===0&&(h=this.getTemplate(u.noResults))}if(h&&!this.isNoResult(h)){if(p){let m={...J.sentimentPrefixes,...this.config.sentimentPrefixes};if(p.label==="negative")h=`${this.salesPsychology.getObjectionPrefix()} ${h}`;else if(p.label==="positive"&&p.intensity==="high"){let w=m.positive||[];w.length>0&&(h=`${w[Math.floor(Math.random()*w.length)]}${h}`)}}t.startsWith("sales_")&&(t==="sales_beli"?h+=` ${this.salesPsychology.getClosingQuestion()}`:c.length>0&&c[0].is_recommended&&(h+=" Produk ini sangat direkomendasikan!"))}return h}getTemplate(e){return e?Array.isArray(e)?e[Math.floor(Math.random()*e.length)]:e:""}isNoResult(e){let t=J.answerTemplates.noResults;return Array.isArray(t)?t.includes(e):e===t}assembleDescription(e,t){let a=this.config.currencySymbol||J.currencySymbol,o=this.config.locale||J.locale,c=`**${e.title}**`;e.category&&(c+=` adalah ${e.category}`);let u=e.sale_price||e.price_numeric;u&&(c+=` yang tersedia dengan harga ${pe(u,a,o)}`);let p={...tt,...this.config.schema},h=t[p.FEATURES]||(e.description&&e.description.length<100?e.description:null);return h?c+=`. Produk ini memiliki keunggulan berupa ${h}.`:c+=".",c}};var $e=null,De=null;async function An(){return $e||De||(De=import("./sastrawi-3Y45XS6Y.mjs").then(I=>($e=new I.Stemmer,$e)),De)}var ue=class{constructor(){this.locale="id";this.stemmer=null;this.initPromise=null}normalize(e){return e.toLowerCase().replace(/[^\w\s]/g,"")}async init(){if(!this.stemmer)return this.initPromise?this.initPromise:(this.initPromise=An().then(e=>{this.stemmer=e}),this.initPromise)}isReady(){return this.stemmer!==null}stem(e){return this.stemmer?this.stemmer.stem(e):(this.init(),e)}getStopWords(){return Mt}},Oe=class{constructor(){this.locale="en"}normalize(e){return e.toLowerCase().replace(/[^\w\s]/g,"")}stem(e){if(e.length<=3)return e;let t=e.toLowerCase();return t.endsWith("ies")?t.slice(0,-3)+"y":(t.endsWith("s")&&(t=t.slice(0,-1)),t.endsWith("ing")?(t=t.slice(0,-3),t.length>3&&t[t.length-1]===t[t.length-2]&&(t=t.slice(0,-1))):t.endsWith("ed")&&(t=t.slice(0,-2),t.length>3&&t[t.length-1]===t[t.length-2]&&(t=t.slice(0,-1))),t)}getStopWords(){return["a","an","the","and","or","but","is","are","was","were","be","been","being","have","has","had","do","does","did","will","shall","should","would","can","could","of","at","by","for","with","about","against","between","into","through","during","before","after","above","below","to","from","up","down","in","out","on","off","over","under","again","further","then","once","here","there","when","where","why","how","all","any","both","each","few","more","most","other","some","such","no","nor","not","only","own","same","so","than","too","very","s","t","can","will","just","don","should","now"]}};var Fe=class{constructor(e={}){this.stemCache=new Map;this.config=e,this.provider=e.languageProvider||new ue}autoCorrect(e){let t=this.config.phoneticMap||et;for(let[a,o]of Object.entries(t))if(o.includes(e))return a;return e}stem(e){if(this.stemCache.has(e))return this.stemCache.get(e);let t=this.provider.stem(e);return this.stemCache.set(e,t),t}process(e){let t={isQuestion:e.includes("?"),isUrgent:e.includes("!")},a=this.config.stopWords?new Set(this.config.stopWords):new Set(this.provider.getStopWords()),c=this.provider.normalize(e).split(/\s+/).filter(k=>k.length>1),u=this.config.phoneticMap||et,p=c.map(k=>{for(let[_,F]of Object.entries(u))if(F.includes(k))return _;return k}),h=p.map(k=>this.stem(k)),w=[...new Set([...p,...h])].filter(k=>!a.has(k)),L=[],T=this.config.semanticMap||Ct;return w.forEach(k=>{T[k]&&L.push(...T[k]);let _=this.stem(k);_!==k&&T[_]&&L.push(...T[_])}),{tokens:w,expanded:[...new Set([...w,...L])],entities:this.extractEntities(w),signals:t}}extractEntities(e){let t={};if(this.config.entityDefinitions)for(let[a,o]of Object.entries(this.config.entityDefinitions))t[a]=e.some(c=>o.includes(c));return t}extractAttributes(e){let t={...e.attributes},a={...Et,...this.config.attributeExtractors||{}},o=e.content||e.description;for(let[c,u]of Object.entries(a))if(!t[c]){let p=o.match(u);p&&(t[c]=p[1])}return t}};var Ue=class{constructor(e={}){this.config=e}calculate(e,t,a,o,c){let u={fuzzyMatch:Math.round((1-a)*10),tokenMatch:0,queryCoverage:0,specificityBonus:0,phraseMatch:0,fieldBoost:0,contextBoost:0,psychologyBoost:0,intentBoost:0,penalty:0},p=u.fuzzyMatch,h=e.title.toLowerCase(),m=(e.keywords||[]).join(" ").toLowerCase(),w=(e.description||"").toLowerCase(),L=(e.content||"").toLowerCase(),T=h+" "+m+" "+w+" "+L,k=t.tokens,_=k.length,F=0;if(k.forEach((P,W)=>{let $=1+(_-W)/_;if(T.includes(P)){F++;let K=10*$;h.includes(P)&&(K+=15*$),m.includes(P)&&(K+=10*$),W>0&&T.includes(k[W-1]+" "+P)&&(K+=12*$),u.tokenMatch+=Math.round(K)}let Q=this.calculateDiceCoefficient(P,h);Q>.4&&(u.tokenMatch+=Math.round(Q*12*$))}),_>0){let P=F/_;u.queryCoverage=Math.round(P*40),P<.5&&_>1&&(u.penalty-=Math.round((.5-P)*30))}let B=h.split(/\s+/).filter(P=>P.length>2),z=m.split(/\s+/).filter(P=>P.length>2),C=[...new Set([...B,...z])];if(C.length>0){let W=C.filter($=>k.some(Q=>Q.includes($)||$.includes(Q))).length/Math.min(C.length,5);u.specificityBonus=Math.round(W*25)}let E=k.join(" ").toLowerCase();if(E.length>3){h.includes(E)?u.phraseMatch+=35:m.includes(E)?u.phraseMatch+=25:w.includes(E)&&(u.phraseMatch+=15);for(let P=0;P<k.length-1;P++){let W=k[P]+" "+k[P+1];h.includes(W)&&(u.phraseMatch+=10)}}return k.forEach(P=>{e.category.toLowerCase().includes(P)&&(u.fieldBoost+=15)}),c.lastCategory===e.category&&(u.contextBoost+=8),(c.lastItemId===e.title||c.lockedEntityId===e.title)&&(u.contextBoost+=25),e.is_recommended&&(u.psychologyBoost+=25),t.signals?.isUrgent&&(u.intentBoost+=8,e.category.toLowerCase().match(/stok|ready|cabang/)&&(u.intentBoost+=20)),o.startsWith("sales_")&&((e.price_numeric||e.sale_price)&&(u.intentBoost+=20),e.category.toLowerCase().match(/produk|layanan/)&&(u.intentBoost+=15)),e.category===(this.config.crawlerCategory||"Page")&&(u.penalty-=25),p+=u.tokenMatch+u.queryCoverage+u.specificityBonus+u.phraseMatch+u.fieldBoost+u.contextBoost+u.psychologyBoost+u.intentBoost+u.penalty,{score:p,breakdown:u}}calculateDiceCoefficient(e,t){if(!e||!t)return 0;let a=h=>{let m=new Set;for(let w=0;w<h.length-1;w++)m.add(h.substring(w,w+2));return m},o=a(e),c=a(t),u=0;o.forEach(h=>{c.has(h)&&u++});let p=o.size+c.size;return p===0?0:2*u/p}calculateComparisonScore(e,t){let a=0;if(e.is_recommended&&(a+=50),e.rating&&(a+=e.rating*10),e.sale_price&&e.price_numeric){let o=(e.price_numeric-e.sale_price)/e.price_numeric;a+=o*100}return a+=Object.keys(t).length*5,a}};var je=class{constructor(){this.events=[];this.startTime=0;this.activePoints=new Map;this.startTime=performance.now()}start(e){this.activePoints.set(e,performance.now())}stop(e,t){let a=this.activePoints.get(e);a&&(this.events.push({id:e,timestamp:a,duration:performance.now()-a,meta:t}),this.activePoints.delete(e))}record(e,t){this.events.push({id:e,timestamp:performance.now(),meta:t})}getEvents(){return[...this.events]}reset(){this.events=[],this.activePoints.clear(),this.startTime=performance.now()}};var Ne=class{constructor(e,t,a,o){this.engines=e,this.searchData=t,this.fuse=a,this.config=o}async search(e){let t=new je;t.start("security_check");let a=this.engines.security.process(e);if(t.stop("security_check",{isValid:a.isValid}),!a.isValid)return{results:[],intent:"blocked",entities:{},confidence:0,answer:"Maaf, input Anda terdeteksi tidak aman."};t.start("middleware_request");let o=await this.engines.middleware.executeRequest(e);if(t.stop("middleware_request"),o.stop)return{results:[],intent:"blocked",entities:{},confidence:0};let c=o.query;this.engines.analytics.track("search",{query:c}),t.start("anaphora_resolution");let u=this.engines.context.resolveAnaphora(c);t.stop("anaphora_resolution"),t.start("sentiment_analysis");let p=this.engines.sentiment.analyze(e);t.stop("sentiment_analysis");let h=this.config.conjunctions||Lt;if(Array.isArray(h)){let k=h.map(_=>_.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"));h=new RegExp(`\\s+(?:${k.join("|")})\\s+|[?!;]|,`,"gi")}let m=u.split(h).map(k=>k.trim()).filter(k=>k.length>0),w={...Ae,...this.config.salesTriggers||{}},L={};for(let[k,_]of Object.entries(w))_.forEach(F=>L[F.toLowerCase()]=k);let T=[];for(let k of m){let _=k.split(/\s+/),F="",B=null;for(let z=0;z<_.length;z++){let C=_[z].toLowerCase().replace(/[^\w]/g,""),E=L[C];E&&B&&E!==B&&F.length>0?(T.push(F.trim()),F=_[z],B=E):(E&&(B=E),F+=(F?" ":"")+_[z])}F&&T.push(F.trim())}if(m=T,m.length>1){let k=[],_=[],F={},B=0;for(let E of m){let P=await this.executeSubSearch(E,t);P.results.forEach(W=>{k.find($=>$.title===W.title)||k.push(W)}),P.answer&&_.push(P.answer),F={...F,...P.entities},B=Math.max(B,P.confidence)}let z=this.config.subSearchJoiner||J.subSearchJoiner,C=this.config.resultLimit||J.resultLimit;return{results:k.slice(0,C),intent:"compound",entities:F,confidence:B,answer:_.join(z).replace(/\.\./g,"."),sentiment:{score:p.score,label:p.label,isUrgent:p.isUrgent,intensity:p.intensity},diagnostics:t.getEvents()}}return this.executeSubSearch(u,t)}async executeSubSearch(e,t){let a=this.config.resultLimit||J.resultLimit;if(this.config.searchMode==="remote"&&this.config.apiUrl){let C=await this.handleRemoteSearch(e,{score:0,label:"neutral"},a);if(C)return C}t.start("preprocessing");let o=this.engines.prepro.process(e);t.stop("preprocessing",{tokenCount:o.tokens.length}),t.start("sentiment_analysis");let c=this.engines.sentiment.analyze(e);t.stop("sentiment_analysis"),c.isUrgent&&(o.signals.isUrgent=!0);let u=[];this.fuse&&(t.start("fuse_search"),u=this.fuse.search(o.expanded.join(" | ")).map(E=>({item:E.item,fuseScore:E.score})),t.stop("fuse_search",{rawResultCount:u.length}));let p=this.engines.context.getState();if(p.lastItemId){let C=this.searchData.find(E=>E.title===p.lastItemId);C&&!u.find(E=>E.item.title===C.title)&&u.push({item:C,fuseScore:.1})}t.start("intent_detection");let h=o.tokens.map(C=>this.engines.prepro.stem(C)),m=this.engines.intent.detect(o.tokens.join(" "),o.tokens,h);t.stop("intent_detection",{intent:m}),t.start("scoring");let w=u.map(C=>{let{score:E,breakdown:P}=this.engines.scoring.calculate(C.item,o,C.fuseScore,m,p);return{item:{...C.item,scoreBreakdown:P},score:E}}).sort((C,E)=>E.score-C.score);t.stop("scoring",{finalCandidateCount:w.length});let L=m.startsWith("chat_"),T=w.filter(C=>C.score>5||L&&C.score>3).map(C=>C.item).slice(0,a),k=w.length>0?Math.min(Math.round(w[0].score*2),100):0,_="",F=m,B=L?80:k;if(T.length===0&&!L&&this.engines.hybridAI){t.start("llm_fallback");let C=await this.engines.hybridAI.fallback(e,{systemPrompt:"You are a helpful assistant for a website. Answer based on general knowledge if product not found.",context:p});C?(_=C,F="generative_fallback",B=70,t.stop("llm_fallback",{success:!0})):t.stop("llm_fallback",{success:!1})}let z={results:T,intent:F,entities:o.entities,confidence:B,sentiment:{score:c.score,label:c.label,isUrgent:c.isUrgent,intensity:c.intensity},scoreBreakdown:w.length>0?w[0].item.scoreBreakdown:void 0,diagnostics:t.getEvents()};return this.engines.context.update(z),_||(t.start("response_composition"),_=this.engines.response.compose(z,m,L,C=>this.engines.prepro.extractAttributes(C)),t.stop("response_composition")),{...z,answer:_,diagnostics:t.getEvents()}}async handleRemoteSearch(e,t,a){try{let o=Array.isArray(this.config.apiUrl)?this.config.apiUrl:[this.config.apiUrl],u=(await Promise.all(o.map(async p=>{try{return await(await fetch(`${p}?q=${encodeURIComponent(e)}`,{headers:this.config.apiHeaders||{}})).json()}catch{return{results:[],intent:"fuzzy",entities:{}}}}))).reduce((p,h)=>(p.results.push(...h.results||[]),h.intent&&h.intent!=="fuzzy"&&(p.intent=h.intent),p.entities={...p.entities,...h.entities||{}},p),{results:[],intent:"fuzzy",entities:{},confidence:0});if(u.results.length>0){let p=this.engines.prepro.process(e),h=this.engines.context.getState(),m=u.intent||"fuzzy",w=u.results.map(L=>{let{score:T,breakdown:k}=this.engines.scoring.calculate(L,p,.5,m,h);return{item:{...L,scoreBreakdown:k},score:T}}).sort((L,T)=>T.score-L.score);return{...u,results:w.map(L=>L.item).slice(0,a),confidence:Math.min(Math.round(w[0].score*2),100),sentiment:{score:t.score,label:t.label,isUrgent:t.isUrgent,intensity:t.intensity},scoreBreakdown:w.length>0?w[0].item.scoreBreakdown:void 0}}}catch(o){console.error("Remote search failed:",o)}return null}async searchWithComparison(e){let t=await this.search(e);if(this.isComparisonQuery(e)){let a=await this.compareProducts(e),o=this.getComparisonLabels(),c=a.recommendation?`${o.recommendation}: **${a.recommendation.item.title}**

${a.tableMarkdown}`:o.noProducts;return{...t,intent:"comparison",answer:c,comparison:a}}return t}isComparisonQuery(e){return(this.config.comparisonTriggers||["bandingkan","vs","lawan","bedanya","lebih bagus mana"]).some(a=>e.toLowerCase().includes(a.toLowerCase()))}async compareProducts(e,t,a=4){let o=t?this.searchData.filter(h=>h.category.toLowerCase().includes(t.toLowerCase())):(await this.search(e)).results;o=o.slice(0,a);let c=o.map(h=>{let m=this.engines.prepro.extractAttributes(h);return{title:h.title,attributes:m,score:this.engines.scoring.calculateComparisonScore(h,m),isRecommended:h.is_recommended||!1,url:h.url,price:h.price_numeric,salePrice:h.sale_price}}).sort((h,m)=>m.score-h.score),u=new Set;c.forEach(h=>Object.keys(h.attributes).forEach(m=>u.add(m)));let p=Array.from(u);return{items:c,attributeLabels:p,recommendation:c.length>0?{item:c[0],reasons:this.generateReasons(c[0],c)}:null,tableHtml:"",tableMarkdown:this.generateTableMarkdown(c,p)}}getComparisonLabels(){return{..._t,...this.config.comparisonLabels||{}}}generateReasons(e,t){let a=[],o=this.getComparisonLabels();if(e.salePrice&&e.price){let u=Math.round((e.price-e.salePrice)/e.price*100);a.push(o.discount.replace("{discount}",u.toString()))}let c=t.filter(u=>u.price||u.salePrice).map(u=>u.salePrice||u.price||1/0);return(e.salePrice||e.price||1/0)===Math.min(...c)&&c.length>1&&a.push(o.cheapest),a}generateTableMarkdown(e,t){let o=`| Fitur | ${e.map(c=>c.title+(c.isRecommended?" \u2728":"")).join(" | ")} |
| :--- | ${e.map(()=>":---").join(" | ")} |
`;for(let c of t){o+=`| **${this.formatAttributeLabel(c)}** |`;for(let u of e){let p=u.attributes[c];o+=` ${p!=null?typeof p=="boolean"?p?"\u2713":"\u2717":p:"-"} |`}o+=`
`}return o}formatAttributeLabel(e){return{...It,...this.config.attributeLabels||{}}[e]||e.charAt(0).toUpperCase()+e.slice(1)}};var We=class I{constructor(e={}){this.config={maxLength:e.maxLength??500,blockScripts:e.blockScripts??!0,blockSqlInjectionPatterns:e.blockSqlInjectionPatterns??!0,allowedTags:e.allowedTags??[],strictMode:e.strictMode??!1}}process(e){if(!e||typeof e!="string")return{isValid:!1,sanitized:"",threats:["Invalid Input Type"],original:e};let t=[],a=e;if(e.length>this.config.maxLength&&(t.push("Length Exceeded"),a=a.substring(0,this.config.maxLength)),this.config.blockScripts){let o=/<script\b[^>]*>([\s\S]*?)<\/script>|javascript:|on\w+=/gi;o.test(a)&&(t.push("Script Injection Attempt"),a=a.replace(o,""))}if(this.config.allowedTags.length===0)a=a.replace(/<[^>]*>/g,"");else{let o=this.config.allowedTags.join("|"),c=new RegExp(`<(?!/?(${o})\\b)[^>]*>`,"gi");a=a.replace(c,"")}if(this.config.blockSqlInjectionPatterns){let o=[/(\b(union|select|insert|update|delete|drop|alter)\b.*\b(from|into|table|database)\b)/i,/(\b1\s*=\s*1\b)/,/(--)/];for(let c of o)c.test(a)&&(t.push("SQL Injection Pattern"),this.config.strictMode&&(a=""))}return a=a.replace(/[\x00-\x08\x0B-\x0C\x0E-\x1F\x7F]/g,""),{isValid:t.length===0||t.length===1&&t[0]==="Length Exceeded",sanitized:a.trim(),threats:t,original:e}}static clean(e){return new I().process(e).sanitized}static isSafe(e){return new I().process(e).isValid}};var me=class{constructor(e,t=Rt.default,a={}){this.searchData=e||[],this.Fuse=t,this.config={phoneticMap:{},semanticMap:{},stopWords:[],entityDefinitions:{},intentRules:[],...a},this.analytics=new ge(this.config.analytics),this.middleware=new Se,this.salesPsychology=new _e(this.config.salesPsychology),this.hybridAI=new Ee(this.config.hybridAI),this.sentimentAnalyzer=new Re(this.config.sentiment),this.securityGuard=new We(this.config.security),this.context=new Pe(this.config.referenceTriggers||he),this.intentOrchestrator=new Le({nlp:this.config.nlp,salesTriggers:this.config.salesTriggers,conversationTriggers:this.config.conversationTriggers,contactTriggers:this.config.contactTriggers}),this.responseEngine=new Te({answerTemplates:this.config.answerTemplates,sentimentPrefixes:this.config.sentimentPrefixes,fallbackIntentResponses:this.config.fallbackIntentResponses,locale:this.config.locale,currencySymbol:this.config.currencySymbol,schema:this.config.schema},this.salesPsychology),this._languageProvider=this.config.locale==="en"?new Oe:new ue,this.prepro=new Fe({languageProvider:this._languageProvider,phoneticMap:this.config.phoneticMap,stopWords:this.config.stopWords,semanticMap:this.config.semanticMap,entityDefinitions:this.config.entityDefinitions,attributeExtractors:this.config.attributeExtractors,crawlerCategory:this.config.crawlerCategory}),this.scoring=new Ue({crawlerCategory:this.config.crawlerCategory}),this.initFuse(),this.orchestrator=new Ne({prepro:this.prepro,intent:this.intentOrchestrator,scoring:this.scoring,context:this.context,response:this.responseEngine,security:this.securityGuard,analytics:this.analytics,middleware:this.middleware,salesPsychology:this.salesPsychology,sentiment:this.sentimentAnalyzer},this.searchData,this.fuse,this.config)}addData(e){this.searchData=[...this.searchData,...e],this.initFuse(),this.orchestrator&&(this.orchestrator.fuse=this.fuse,this.orchestrator.searchData=this.searchData)}initFuse(){this.Fuse&&(this.fuse=new this.Fuse(this.searchData,{keys:[{name:"title",weight:.8},{name:"keywords",weight:.5},{name:"description",weight:.2}],threshold:.45,includeScore:!0,useExtendedSearch:!0,ignoreLocation:!0,minMatchCharLength:2}))}async init(){this._languageProvider?.init&&await this._languageProvider.init()}isReady(){return this._languageProvider?.isReady?this._languageProvider.isReady():!0}async search(e){return this.orchestrator.search(e)}isComparisonQuery(e){return this.orchestrator.isComparisonQuery(e)}async compareProducts(e,t,a){return this.orchestrator.compareProducts(e,t,a)}async searchWithComparison(e){return this.orchestrator.searchWithComparison(e)}};var ye=class{constructor(e="",t={}){this.baseUrl=e||(typeof window<"u"?window.location.origin:""),this.visited=new Set,this.data=[],this.config={maxDepth:2,maxPages:50,ignorePatterns:[/\.(jpg|jpeg|png|gif|pdf|css|js|json|svg|ico)$/i,/#.*$/,/mailto:/,/tel:/],category:"Page",...t}}markAsVisited(e){this.visited.add(e)}async crawlAll(e="/"){if(!this.baseUrl)return console.error("SiteCrawler: Base URL not set. Cannot crawl."),[];let a=[{url:new URL(e,this.baseUrl).href,depth:0}];for(;a.length>0&&this.data.length<(this.config.maxPages||50);){let o=a.shift();if(!o)break;if(!this.visited.has(o.url)&&!(o.depth>(this.config.maxDepth||2)))try{if(this.shouldIgnore(o.url)){this.visited.add(o.url),this.config.onProgress&&this.config.onProgress({url:o.url,totalIndexed:this.data.length,status:"ignored"});continue}this.config.onProgress&&this.config.onProgress({url:o.url,totalIndexed:this.data.length,status:"crawling"});let c=await this.processPage(o.url);this.visited.add(o.url),c&&(this.data.push(c.data),this.config.onProgress&&this.config.onProgress({url:o.url,totalIndexed:this.data.length,status:"indexed"}),o.depth<(this.config.maxDepth||2)&&c.links.forEach(u=>{this.visited.has(u)||a.push({url:u,depth:o.depth+1})}))}catch(c){if(console.warn(`SiteCrawler: Failed to crawl ${o.url}`,c),this.visited.add(o.url),this.config.onProgress){let u="failed";window.location.protocol==="file:"?u="local_file_cors":c.name==="TypeError"&&(u="network_error"),this.config.onProgress({url:o.url,totalIndexed:this.data.length,status:u})}}}return this.data}shouldIgnore(e){return!!this.config.ignorePatterns?.some(t=>typeof t=="string"?e.includes(t):t.test(e))}processDocument(e,t,a="Page"){let o=e.querySelector("title")?.textContent||"",c=e.querySelector('meta[name="description"]')?.getAttribute("content")||"",u=this.extractMainContent(e);return{title:o.trim()||new URL(t).pathname,description:c.trim()||u.substring(0,150)+"...",url:t,category:a,keywords:this.extractKeywords(e),content:u}}async processPage(e){let t=await fetch(e);if(!t.ok)return null;let a=t.headers.get("content-type");if(!a||!a.includes("text/html"))return null;let o=await t.text(),c=new DOMParser().parseFromString(o,"text/html"),u=this.processDocument(c,e,this.config.category),p=Array.from(c.querySelectorAll("a[href]")).map(h=>h.getAttribute("href")).filter(h=>h&&!h.startsWith("#")&&!h.startsWith("javascript:")).map(h=>{try{return new URL(h,this.baseUrl).href}catch{return null}}).filter(h=>!!h&&h.startsWith(this.baseUrl));return{data:u,links:p}}extractMainContent(e){let t=e.body.cloneNode(!0);if(t.querySelectorAll('script, style, noscript, iframe, header, footer, nav, button, input, select, textarea, form, svg, canvas, [role="button"], [role="navigation"]').forEach(c=>c.remove()),this.config.excludeSelectors&&t.querySelectorAll(this.config.excludeSelectors).forEach(u=>u.remove()),this.config.contentSelectors){let c=t.querySelectorAll(this.config.contentSelectors);if(c.length>0)return Array.from(c).map(u=>u.innerText).join(" ").replace(/\s+/g," ").trim()}return t.innerText.replace(/\s+/g," ").trim()}extractKeywords(e){let t=e.querySelector('meta[name="keywords"]')?.getAttribute("content");return t?t.split(",").map(a=>a.trim()):[]}};var Be=class{constructor(){this.container=null;this.crawlerContainer=null;this.isVisible=!1;typeof document<"u"&&this.initContainer()}initContainer(){this.container=document.createElement("div"),this.container.id="aib-dev-hud",this.container.style.cssText=`
            position: fixed;
            top: 20px;
            right: 20px;
            width: 300px;
            max-height: 80vh;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(12px);
            color: #f8fafc;
            border-radius: 16px;
            padding: 20px;
            font-family: 'Inter', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 11px;
            z-index: 999999;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            display: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        `,document.body.appendChild(this.container),this.crawlerContainer=document.createElement("div"),this.crawlerContainer.id="aib-crawler-hud",this.crawlerContainer.style.cssText=`
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.1);
        `,this.crawlerContainer.innerHTML=`
            <p style="color: #94a3b8; font-weight: bold; margin-bottom: 8px; font-size: 9px; text-transform: uppercase;">Crawler Status</p>
            <div style="background: rgba(255,255,255,0.03); padding: 8px; border-radius: 4px; color: #64748b; font-style: italic;">
                Initializing discovery...
            </div>
        `,this.container.appendChild(this.crawlerContainer)}update(e){if(!this.container)return;this.isVisible=!0,this.container.style.display="block";let t=`
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 8px;">
                <span style="font-weight: 800; font-size: 10px; text-transform: uppercase; letter-spacing: 0.05em; color: #38bdf8;">Dev Mode (HUD)</span>
                <span style="background: rgba(56, 189, 248, 0.2); color: #7dd3fc; padding: 2px 6px; border-radius: 4px; font-size: 9px;">Intent: ${e.intent}</span>
            </div>
        `;e.diagnostics&&e.diagnostics.length>0&&(t+=`<div style="margin-bottom: 15px;">
                <p style="color: #94a3b8; font-weight: bold; margin-bottom: 8px; font-size: 9px; text-transform: uppercase;">Pipeline Performance</p>
                <div style="display: flex; flex-direction: column; gap: 4px;">`,e.diagnostics.forEach(a=>{let o=a.duration?a.duration.toFixed(2):"-",c=a.duration&&a.duration>10?"#f87171":a.duration&&a.duration>5?"#fbbf24":"#34d399";t+=`
                    <div style="display: flex; justify-content: space-between; background: rgba(255,255,255,0.03); padding: 4px 8px; border-radius: 4px;">
                        <span style="color: #cbd5e1;">${a.id}</span>
                        <span style="color: ${c}; font-weight: bold;">${o}ms</span>
                    </div>
                `}),t+="</div></div>"),e.scoreBreakdown&&(t+=`<div>
                <p style="color: #94a3b8; font-weight: bold; margin-bottom: 8px; font-size: 9px; text-transform: uppercase;">Top Result Scoring</p>
                <div style="display: flex; flex-direction: column; gap: 4px;">`,Object.entries(e.scoreBreakdown).forEach(([a,o])=>{if(o===0)return;let c=o<0;t+=`
                    <div style="display: flex; justify-content: space-between; background: rgba(255,255,255,0.03); padding: 4px 8px; border-radius: 4px;">
                        <span style="color: #cbd5e1;">${a}</span>
                        <span style="color: ${c?"#f87171":"#38bdf8"}; font-weight: bold;">${o>0?"+":""}${o}</span>
                    </div>
                `}),t+="</div></div>"),t+=`
            <div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1);">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <span style="color: #94a3b8;">Total Confidence</span>
                    <span style="font-weight: bold; color: #38bdf8;">${e.confidence}%</span>
                </div>
                <div style="width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; overflow: hidden;">
                    <div style="width: ${e.confidence}%; height: 100%; background: #38bdf8;"></div>
                </div>
            </div>
        `,this.container.innerHTML=t,this.container.appendChild(this.crawlerContainer)}updateCrawlerStatus(e){if(!this.container||!this.crawlerContainer)return;this.isVisible=!0,this.container.style.display="block",this.crawlerContainer.style.display="block";let t={crawling:"#38bdf8",indexed:"#34d399",ignored:"#94a3b8",failed:"#f87171"};this.crawlerContainer.innerHTML=`
            <p style="color: #94a3b8; font-weight: bold; margin-bottom: 8px; font-size: 9px; text-transform: uppercase;">Crawler Status</p>
            <div style="background: rgba(255,255,255,0.03); padding: 8px; border-radius: 4px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <span style="color: #cbd5e1;">Items Indexed</span>
                    <span style="color: #34d399; font-weight: bold;">${e.totalIndexed}</span>
                </div>
                <div style="font-size: 9px; color: #94a3b8; word-break: break-all; margin-top: 4px;">
                    <span style="color: ${t[e.status]||"#cbd5e1"}; font-weight: bold;">[${e.status.toUpperCase()}]</span> 
                    ${e.url.replace(window.location.origin,"")||"/"}
                </div>
            </div>
        `}toggle(){this.container&&(this.isVisible=!this.isVisible,this.container.style.display=this.isVisible?"block":"none")}};var it=class{constructor(e,t=void 0,a={},o={}){this.elements={};this.chatHistory=[];this.interactionCount=0;this.devModeUI=null;this.engine=new me(e,t,o),this.selectors=a,this.config=o,this.config.debugMode&&typeof window<"u"&&(this.devModeUI=new Be),this.initElements(),this.initEventListeners(),this.loadHistory(),this.initCrawler()}async initCrawler(){if(this.config.autoCrawl!==!1&&typeof window<"u"){let e=new ye(window.location.origin,{maxDepth:this.config.crawlMaxDepth,maxPages:this.config.crawlMaxPages,ignorePatterns:this.config.crawlIgnorePatterns,autoCrawl:this.config.autoCrawl,category:this.config.crawlerCategory||"Page",onProgress:a=>{this.devModeUI&&this.devModeUI.updateCrawlerStatus(a)}});try{let a=e.processDocument(document,window.location.href,this.config.crawlerCategory||"Page"),o=this.config.crawlerKeywords||[];a.keywords=[...a.keywords||[],...o],a.is_recommended=!0,this.engine.addData([a]),e.markAsVisited(window.location.href),this.devModeUI&&this.devModeUI.updateCrawlerStatus({url:window.location.pathname,totalIndexed:1,status:"indexed"}),console.log("Assistant: Immediate indexing complete",a)}catch(a){console.warn("Assistant: Immediate indexing failed",a)}let t=typeof window<"u"?window.location.pathname:"/";e.crawlAll(t).then(a=>{a.length>0&&(this.engine.addData(a),console.log(`Assistant: Background Crawl Complete. Crawled ${a.length} pages. Data:`,a))})}}initElements(){this.elements.overlay=document.getElementById(this.selectors.overlayId),this.elements.input=document.getElementById(this.selectors.inputId),this.elements.sendBtn=document.getElementById(this.selectors.sendBtnId),this.elements.closeBtn=document.getElementById(this.selectors.closeBtnId),this.elements.chatContainer=document.getElementById(this.selectors.chatContainerId),this.elements.messagesList=document.getElementById(this.selectors.messagesListId),this.elements.typingIndicator=document.getElementById(this.selectors.typingIndicatorId),this.elements.welcomeMsg=document.querySelector(`.${this.selectors.welcomeMsgClass}`)}initEventListeners(){let e=this.elements.input;e&&e.addEventListener("keydown",t=>{t.key==="Enter"&&this.performAction()}),this.elements.sendBtn&&this.elements.sendBtn.addEventListener("click",()=>this.performAction()),this.elements.closeBtn&&this.elements.closeBtn.addEventListener("click",()=>this.closeAssistant()),document.querySelectorAll(`.${this.selectors.quickLinksClass}`).forEach(t=>{let a=t;a.addEventListener("click",()=>{e&&a.dataset.query&&(e.value=a.dataset.query,this.performAction())})}),document.addEventListener("keydown",t=>{t.key==="Escape"&&this.elements.overlay&&!this.elements.overlay.classList.contains("hidden")&&this.closeAssistant(),(t.metaKey||t.ctrlKey)&&t.key==="k"&&(t.preventDefault(),this.openAssistant())}),this.elements.overlay&&this.elements.overlay.addEventListener("click",t=>{t.target===this.elements.overlay&&this.closeAssistant()})}openAssistant(){let e=this.elements.overlay,t=this.elements.input;!e||!t||(e.classList.remove("hidden"),setTimeout(()=>{e.classList.remove("opacity-0"),t.focus(),this.elements.welcomeMsg&&this.elements.welcomeMsg.classList.remove("opacity-0","translate-y-4")},10),document.body.style.overflow="hidden")}closeAssistant(){let e=this.elements.overlay,t=this.elements.input;!e||!t||(e.classList.add("opacity-0"),setTimeout(()=>{e.classList.add("hidden"),t.value=""},300),document.body.style.overflow="")}performAction(){let e=this.elements.input;if(!e)return;let t=e.value;t.trim()&&(e.value="",this.addUserMessage(t),this.showTyping(),setTimeout(async()=>{this.hideTyping();let a=await this.engine.searchWithComparison(t);this.devModeUI&&this.devModeUI.update(a),this.addAssistantMessage(t,a)},1e3))}showTyping(){let e=this.elements.typingIndicator;e&&(e.classList.remove("hidden"),setTimeout(()=>e.classList.remove("opacity-0"),10),this.scrollToBottom())}hideTyping(){let e=this.elements.typingIndicator;e&&(e.classList.add("opacity-0"),setTimeout(()=>e.classList.add("hidden"),300))}scrollToBottom(){let e=this.elements.chatContainer;e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}addUserMessage(e,t=!0){if(!this.elements.messagesList)return;let a=document.createElement("div");a.className="bubble-container user opacity-0 translate-y-4 bubble-user";let o=this.config.uiTemplates?.renderUserMessage;a.innerHTML=o?o(e):`
            <div class="bg-gradient-to-br from-primary to-primary-dark text-white p-5 rounded-3xl rounded-tr-none shadow-xl max-w-[85%] border border-white/10">
                <p class="text-sm md:text-base font-semibold tracking-tight">${e}</p>
            </div>`,this.elements.messagesList.appendChild(a),t&&(this.chatHistory.push({type:"user",text:e}),this.saveHistory())}addAssistantMessage(e,t,a=!0){if(!this.elements.messagesList)return;this.interactionCount++,a&&(this.chatHistory.push({type:"assistant",text:e,result:t}),this.saveHistory());let o=document.createElement("div");o.className="bubble-container assistant opacity-0 translate-y-4 bubble-assistant";let c=this.generateResponseHTML(e,t),u=this.config.uiTemplates?.renderAssistantContainer;o.innerHTML=u?u(c,t):`
            <div class="w-11 h-11 rounded-2xl bg-white flex items-center justify-center text-primary shrink-0 shadow-lg border border-gray-100 hidden md:flex">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                </svg>
            </div>
            <div class="space-y-3 max-w-[92%] md:max-w-[85%]">
                <div class="bg-white/80 backdrop-blur-md p-6 rounded-3xl rounded-tl-none shadow-2xl border border-white/40 text-dark leading-relaxed">
                    ${c}
                </div>
            </div>`,this.elements.messagesList.appendChild(o),this.scrollToBottom()}generateResponseHTML(e,t){let{results:a,confidence:o,answer:c,comparison:u}=t,p="";if(u&&u.items&&u.items.length>0)return this.config.uiTemplates?.renderComparison?this.config.uiTemplates.renderComparison(u):(u.recommendation&&(p+=`<div class="mb-4 p-4 bg-gradient-to-r from-primary/10 to-accent/10 rounded-2xl border border-primary/20">
                    <p class="text-xs uppercase tracking-wider text-primary font-bold mb-2">\u{1F3C6} Rekomendasi Kami</p>
                    <p class="text-base font-bold text-dark">${u.recommendation.item.title}</p>
                    ${u.recommendation.reasons.length>0?`
                        <ul class="mt-2 text-xs text-gray-600 list-disc list-inside">
                            ${u.recommendation.reasons.map(h=>`<li>${h}</li>`).join("")}
                        </ul>
                    `:""}
                </div>`),p+=`<div class="overflow-x-auto mt-4">${u.tableHtml}</div>`,p+='<div class="flex flex-wrap gap-2 mt-4">',u.items.forEach((h,m)=>{let w=m===0;p+=`<a href="${h.url}" class="px-4 py-2 text-xs font-bold rounded-xl transition-all ${w?"bg-primary text-white hover:bg-primary-dark":"bg-gray-100 text-gray-700 hover:bg-gray-200"}">${h.title}</a>`}),p+="</div>",p);if(c){if(p+=`<p class="text-sm md:text-base font-medium mb-4">${this.formatText(c)}</p>`,t.intent==="chat_contact"&&this.config.whatsappNumber){let h=`https://wa.me/${this.config.whatsappNumber}?text=${encodeURIComponent("Halo, saya ingin bertanya tentang: "+e)}`;p+=`
                <div class="mt-4">
                    <a href="${h}" target="_blank" class="inline-flex items-center gap-2 px-6 py-3 bg-[#25D366] text-white font-bold rounded-2xl hover:bg-[#128C7E] transition-all shadow-lg hover:scale-105 active:scale-95">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
                        Hubungi WhatsApp
                    </a>
                </div>`,setTimeout(()=>{window.open(h,"_blank")},2e3)}}else if(a.length>0){let h=a[0];p+=`<p class="text-sm md:text-base font-medium mb-4">${this.formatText(h.answer||h.description)}</p>`}if(a.length>0){let h=a.filter(m=>m.category!=="Sapaan").slice(0,3).map((m,w)=>{let L=!!(w===0&&(m.price_numeric||m.sale_price||m.is_recommended));if(this.config.uiTemplates?.renderResultCard)return this.config.uiTemplates.renderResultCard(m,w,L);let T=m.cta_label||(m.category.includes("Produk")||m.category.includes("Layanan")?"Pesan Sekarang":"Lihat Detail");return`
                <a href="${m.cta_url||m.url}" class="flex gap-4 p-4 ${L?"bg-primary/5 border-primary/40 shadow-lg ring-1 ring-primary/20":"bg-white/50 border-gray-100"} hover:bg-white hover:scale-[1.01] hover:shadow-2xl rounded-2xl border transition-all group w-full mb-3 no-underline">
                    ${m.image_url?`
                        <div class="relative w-24 h-24 shrink-0 overflow-hidden rounded-xl border border-gray-100 bg-gray-50">
                            <img src="${m.image_url}" alt="${m.title}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                        </div>
                    `:""}
                    <div class="flex-1 flex flex-col justify-between min-w-0">
                        <div>
                            <div class="flex items-center justify-between gap-2 mb-1">
                                <span class="text-[9px] font-black text-white bg-primary px-2 py-0.5 rounded-lg uppercase tracking-wider">${m.category}</span>
                                ${m.price_numeric?`
                                    <div class="text-right">
                                        <span class="text-xs font-extrabold text-primary">${this.formatCurrency(m.sale_price||m.price_numeric)}</span>
                                    </div>
                                `:""}
                            </div>
                            <h4 class="font-bold text-dark text-sm leading-tight group-hover:text-primary transition-colors truncate">${m.title}</h4>
                            <p class="text-[11px] text-gray-500 line-clamp-2 leading-snug mt-1">${m.description}</p>
                        </div>
                        <div class="flex items-center justify-between mt-3 pt-2 border-t border-gray-50/50">
                            <div class="flex gap-1">
                                ${m.badge_text?`<span class="text-[8px] font-bold text-red-500 bg-red-50 px-1.5 py-0.5 rounded uppercase">${m.badge_text}</span>`:""}
                                ${m.is_recommended?'<span class="text-[8px] font-bold text-orange-600 bg-orange-50 px-1.5 py-0.5 rounded uppercase">\u2728 Best</span>':""}
                            </div>
                            <span class="text-primary text-[10px] font-bold flex items-center gap-1 group-hover:translate-x-1 transition-transform">
                                ${T}
                                <svg class="w-2 h-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M9 5l7 7-7 7"></path></svg>
                            </span>
                        </div>
                    </div>
                </a>`}).join("");h&&(p+=`<div class="mt-4">${h}</div>`)}else c||(p='<p class="flex items-center gap-2 text-gray-400 italic text-sm"><svg class="w-4 h-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> Maaf, saya belum menemukan jawaban yang pas. Silakan hubungi admin kami via WhatsApp.</p>',this.config.whatsappNumber&&setTimeout(()=>{let h=`https://wa.me/${this.config.whatsappNumber}?text=${encodeURIComponent("Halo, saya ingin bertanya tentang: "+e)}`;window.open(h,"_blank")},2e3));return p}formatText(e){return e.replace(/\*\*(.*?)\*\*/g,'<span class="font-bold text-primary">$1</span>')}formatCurrency(e){return pe(e,this.config.currencySymbol||"Rp",this.config.locale||"id-ID")}saveHistory(){localStorage.setItem("assistant_chat_history",JSON.stringify(this.chatHistory))}loadHistory(){let e=localStorage.getItem("assistant_chat_history");if(e)try{this.chatHistory=JSON.parse(e),this.chatHistory.forEach(t=>{t.type==="user"?this.addUserMessage(t.text,!1):t.type==="assistant"&&t.result&&this.addAssistantMessage(t.text,t.result,!1)})}catch(t){console.error("History load error",t)}}};export{it as AssistantController,me as AssistantEngine,ye as SiteCrawler};
