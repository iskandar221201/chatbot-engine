"use strict";var Dt=Object.create;var le=Object.defineProperty;var Ht=Object.getOwnPropertyDescriptor;var Wt=Object.getOwnPropertyNames;var Bt=Object.getPrototypeOf,zt=Object.prototype.hasOwnProperty;var Kt=(P,i)=>()=>(i||P((i={exports:{}}).exports,i),i.exports),Ut=(P,i)=>{for(var s in i)le(P,s,{get:i[s],enumerable:!0})},Be=(P,i,s,u)=>{if(i&&typeof i=="object"||typeof i=="function")for(let c of Wt(i))!zt.call(P,c)&&c!==s&&le(P,c,{get:()=>i[c],enumerable:!(u=Ht(i,c))||u.enumerable});return P};var Gt=(P,i,s)=>(s=P!=null?Dt(Bt(P)):{},Be(i||!P||!P.__esModule?le(s,"default",{value:P,enumerable:!0}):s,P)),Vt=P=>Be(le({},"__esModule",{value:!0}),P);var ze=Kt((ke,Me)=>{"use strict";(function(P,i){typeof ke=="object"&&typeof Me<"u"?Me.exports=i():typeof define=="function"&&define.amd?define(i):(P=typeof globalThis<"u"?globalThis:P||self,P.Fuse=i())})(ke,(function(){"use strict";function P(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,r)}return e}function i(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?P(Object(e),!0).forEach(function(r){l(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):P(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}function s(t){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s(t)}function u(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function c(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_e(r.key),r)}}function f(t,n,e){return n&&c(t.prototype,n),e&&c(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,n,e){return n=_e(n),n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function m(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&g(t,n)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(t)}function g(t,n){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},g(t,n)}function I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(t,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b(t)}function C(t){var n=I();return function(){var r=y(t),a;if(n){var o=y(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return L(this,a)}}function F(t){return J(t)||Ue(t)||Ge(t)||Ve()}function J(t){if(Array.isArray(t))return he(t)}function Ue(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ge(t,n){if(t){if(typeof t=="string")return he(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return he(t,n)}}function he(t,n){(n==null||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Ve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qe(t,n){if(typeof t!="object"||t===null)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var r=e.call(t,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function _e(t){var n=Qe(t,"string");return typeof n=="symbol"?n:String(n)}function K(t){return Array.isArray?Array.isArray(t):Se(t)==="[object Array]"}var Ye=1/0;function Je(t){if(typeof t=="string")return t;var n=t+"";return n=="0"&&1/t==-Ye?"-0":n}function Xe(t){return t==null?"":Je(t)}function H(t){return typeof t=="string"}function we(t){return typeof t=="number"}function Ze(t){return t===!0||t===!1||qe(t)&&Se(t)=="[object Boolean]"}function Le(t){return s(t)==="object"}function qe(t){return Le(t)&&t!==null}function D(t){return t!=null}function de(t){return!t.trim().length}function Se(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}var Yt="Extended search is not available",et="Incorrect 'index' type",tt=function(n){return"Invalid value for key ".concat(n)},nt=function(n){return"Pattern length exceeds max of ".concat(n,".")},rt=function(n){return"Missing ".concat(n," property in key")},it=function(n){return"Property 'weight' in key '".concat(n,"' must be a positive integer")},Ie=Object.prototype.hasOwnProperty,st=(function(){function t(n){var e=this;u(this,t),this._keys=[],this._keyMap={};var r=0;n.forEach(function(a){var o=$e(a);e._keys.push(o),e._keyMap[o.id]=o,r+=o.weight}),this._keys.forEach(function(a){a.weight/=r})}return f(t,[{key:"get",value:function(e){return this._keyMap[e]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),t})();function $e(t){var n=null,e=null,r=null,a=1,o=null;if(H(t)||K(t))r=t,n=Ae(t),e=fe(t);else{if(!Ie.call(t,"name"))throw new Error(rt("name"));var d=t.name;if(r=d,Ie.call(t,"weight")&&(a=t.weight,a<=0))throw new Error(it(d));n=Ae(d),e=fe(d),o=t.getFn}return{path:n,id:e,weight:a,src:r,getFn:o}}function Ae(t){return K(t)?t:t.split(".")}function fe(t){return K(t)?t.join("."):t}function at(t,n){var e=[],r=!1,a=function o(d,h,p){if(D(d))if(!h[p])e.push(d);else{var x=h[p],v=d[x];if(!D(v))return;if(p===h.length-1&&(H(v)||we(v)||Ze(v)))e.push(Xe(v));else if(K(v)){r=!0;for(var M=0,k=v.length;M<k;M+=1)o(v[M],h,p+1)}else h.length&&o(v,h,p+1)}};return a(t,H(n)?n.split("."):n,0),r?e:e[0]}var ot={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},ct={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(n,e){return n.score===e.score?n.idx<e.idx?-1:1:n.score<e.score?-1:1}},lt={location:0,threshold:.6,distance:100},ut={useExtendedSearch:!1,getFn:at,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},_=i(i(i(i({},ct),ot),lt),ut),ht=/[^ ]+/g;function dt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,e=new Map,r=Math.pow(10,n);return{get:function(o){var d=o.match(ht).length;if(e.has(d))return e.get(d);var h=1/Math.pow(d,.5*t),p=parseFloat(Math.round(h*r)/r);return e.set(d,p),p},clear:function(){e.clear()}}}var ge=(function(){function t(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.getFn,r=e===void 0?_.getFn:e,a=n.fieldNormWeight,o=a===void 0?_.fieldNormWeight:a;u(this,t),this.norm=dt(o,3),this.getFn=r,this.isCreated=!1,this.setIndexRecords()}return f(t,[{key:"setSources",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.docs=e}},{key:"setIndexRecords",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.records=e}},{key:"setKeys",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.keys=r,this._keysMap={},r.forEach(function(a,o){e._keysMap[a.id]=o})}},{key:"create",value:function(){var e=this;this.isCreated||!this.docs.length||(this.isCreated=!0,H(this.docs[0])?this.docs.forEach(function(r,a){e._addString(r,a)}):this.docs.forEach(function(r,a){e._addObject(r,a)}),this.norm.clear())}},{key:"add",value:function(e){var r=this.size();H(e)?this._addString(e,r):this._addObject(e,r)}},{key:"removeAt",value:function(e){this.records.splice(e,1);for(var r=e,a=this.size();r<a;r+=1)this.records[r].i-=1}},{key:"getValueForItemAtKeyId",value:function(e,r){return e[this._keysMap[r]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(e,r){if(!(!D(e)||de(e))){var a={v:e,i:r,n:this.norm.get(e)};this.records.push(a)}}},{key:"_addObject",value:function(e,r){var a=this,o={i:r,$:{}};this.keys.forEach(function(d,h){var p=d.getFn?d.getFn(e):a.getFn(e,d.path);if(D(p)){if(K(p)){for(var x=[],v=[{nestedArrIndex:-1,value:p}];v.length;){var M=v.pop(),k=M.nestedArrIndex,w=M.value;if(D(w))if(H(w)&&!de(w)){var S={v:w,i:k,n:a.norm.get(w)};x.push(S)}else K(w)&&w.forEach(function($,E){v.push({nestedArrIndex:E,value:$})})}o.$[h]=x}else if(H(p)&&!de(p)){var A={v:p,n:a.norm.get(p)};o.$[h]=A}}}),this.records.push(o)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),t})();function Ce(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.getFn,a=r===void 0?_.getFn:r,o=e.fieldNormWeight,d=o===void 0?_.fieldNormWeight:o,h=new ge({getFn:a,fieldNormWeight:d});return h.setKeys(t.map($e)),h.setSources(n),h.create(),h}function ft(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=n.getFn,r=e===void 0?_.getFn:e,a=n.fieldNormWeight,o=a===void 0?_.fieldNormWeight:a,d=t.keys,h=t.records,p=new ge({getFn:r,fieldNormWeight:o});return p.setKeys(d),p.setIndexRecords(h),p}function ne(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=n.errors,r=e===void 0?0:e,a=n.currentLocation,o=a===void 0?0:a,d=n.expectedLocation,h=d===void 0?0:d,p=n.distance,x=p===void 0?_.distance:p,v=n.ignoreLocation,M=v===void 0?_.ignoreLocation:v,k=r/t.length;if(M)return k;var w=Math.abs(h-o);return x?k+w/x:w?1:k}function gt(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.minMatchCharLength,e=[],r=-1,a=-1,o=0,d=t.length;o<d;o+=1){var h=t[o];h&&r===-1?r=o:!h&&r!==-1&&(a=o-1,a-r+1>=n&&e.push([r,a]),r=-1)}return t[o-1]&&o-r>=n&&e.push([r,o-1]),e}var V=32;function pt(t,n,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=r.location,o=a===void 0?_.location:a,d=r.distance,h=d===void 0?_.distance:d,p=r.threshold,x=p===void 0?_.threshold:p,v=r.findAllMatches,M=v===void 0?_.findAllMatches:v,k=r.minMatchCharLength,w=k===void 0?_.minMatchCharLength:k,S=r.includeMatches,A=S===void 0?_.includeMatches:S,$=r.ignoreLocation,E=$===void 0?_.ignoreLocation:$;if(n.length>V)throw new Error(nt(V));for(var O=n.length,N=t.length,R=Math.max(0,Math.min(o,N)),T=x,j=R,W=w>1||A,Q=W?Array(N):[],B;(B=t.indexOf(n,j))>-1;){var je=ne(n,{currentLocation:B,expectedLocation:R,distance:h,ignoreLocation:E});if(T=Math.min(je,T),j=B+O,W)for(var Z=0;Z<O;)Q[B+Z]=1,Z+=1}j=-1;for(var q=[],se=1,ae=O+N,Nt=1<<O-1,Y=0;Y<O;Y+=1){for(var oe=0,G=ae;oe<G;){var Ft=ne(n,{errors:Y,currentLocation:R+G,expectedLocation:R,distance:h,ignoreLocation:E});Ft<=T?oe=G:ae=G,G=Math.floor((ae-oe)/2+oe)}ae=G;var De=Math.max(1,R-G+1),be=M?N:Math.min(R+G,N)+O,ee=Array(be+2);ee[be+1]=(1<<Y)-1;for(var z=be;z>=De;z-=1){var ce=z-1,He=e[t.charAt(ce)];if(W&&(Q[ce]=+!!He),ee[z]=(ee[z+1]<<1|1)&He,Y&&(ee[z]|=(q[z+1]|q[z])<<1|1|q[z+1]),ee[z]&Nt&&(se=ne(n,{errors:Y,currentLocation:ce,expectedLocation:R,distance:h,ignoreLocation:E}),se<=T)){if(T=se,j=ce,j<=R)break;De=Math.max(1,2*R-j)}}var jt=ne(n,{errors:Y+1,currentLocation:R,expectedLocation:R,distance:h,ignoreLocation:E});if(jt>T)break;q=ee}var xe={isMatch:j>=0,score:Math.max(.001,se)};if(W){var We=gt(Q,w);We.length?A&&(xe.indices=We):xe.isMatch=!1}return xe}function mt(t){for(var n={},e=0,r=t.length;e<r;e+=1){var a=t.charAt(e);n[a]=(n[a]||0)|1<<r-e-1}return n}var Ee=(function(){function t(n){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.location,o=a===void 0?_.location:a,d=r.threshold,h=d===void 0?_.threshold:d,p=r.distance,x=p===void 0?_.distance:p,v=r.includeMatches,M=v===void 0?_.includeMatches:v,k=r.findAllMatches,w=k===void 0?_.findAllMatches:k,S=r.minMatchCharLength,A=S===void 0?_.minMatchCharLength:S,$=r.isCaseSensitive,E=$===void 0?_.isCaseSensitive:$,O=r.ignoreLocation,N=O===void 0?_.ignoreLocation:O;if(u(this,t),this.options={location:o,threshold:h,distance:x,includeMatches:M,findAllMatches:w,minMatchCharLength:A,isCaseSensitive:E,ignoreLocation:N},this.pattern=E?n:n.toLowerCase(),this.chunks=[],!!this.pattern.length){var R=function(Z,q){e.chunks.push({pattern:Z,alphabet:mt(Z),startIndex:q})},T=this.pattern.length;if(T>V){for(var j=0,W=T%V,Q=T-W;j<Q;)R(this.pattern.substr(j,V),j),j+=V;if(W){var B=T-V;R(this.pattern.substr(B),B)}}else R(this.pattern,0)}}return f(t,[{key:"searchIn",value:function(e){var r=this.options,a=r.isCaseSensitive,o=r.includeMatches;if(a||(e=e.toLowerCase()),this.pattern===e){var d={isMatch:!0,score:0};return o&&(d.indices=[[0,e.length-1]]),d}var h=this.options,p=h.location,x=h.distance,v=h.threshold,M=h.findAllMatches,k=h.minMatchCharLength,w=h.ignoreLocation,S=[],A=0,$=!1;this.chunks.forEach(function(O){var N=O.pattern,R=O.alphabet,T=O.startIndex,j=pt(e,N,R,{location:p+T,distance:x,threshold:v,findAllMatches:M,minMatchCharLength:k,includeMatches:o,ignoreLocation:w}),W=j.isMatch,Q=j.score,B=j.indices;W&&($=!0),A+=Q,W&&B&&(S=[].concat(F(S),F(B)))});var E={isMatch:$,score:$?A/this.chunks.length:1};return $&&o&&(E.indices=S),E}}]),t})(),U=(function(){function t(n){u(this,t),this.pattern=n}return f(t,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(e){return Re(e,this.multiRegex)}},{key:"isSingleMatch",value:function(e){return Re(e,this.singleRegex)}}]),t})();function Re(t,n){var e=t.match(n);return e?e[1]:null}var vt=(function(t){m(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=a===this.pattern;return{isMatch:o,score:o?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),e})(U),yt=(function(t){m(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=a.indexOf(this.pattern),d=o===-1;return{isMatch:d,score:d?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),e})(U),bt=(function(t){m(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=a.startsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),e})(U),xt=(function(t){m(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=!a.startsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),e})(U),kt=(function(t){m(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=a.endsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[a.length-this.pattern.length,a.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),e})(U),Mt=(function(t){m(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=!a.endsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),e})(U),Pe=(function(t){m(e,t);var n=C(e);function e(r){var a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=o.location,h=d===void 0?_.location:d,p=o.threshold,x=p===void 0?_.threshold:p,v=o.distance,M=v===void 0?_.distance:v,k=o.includeMatches,w=k===void 0?_.includeMatches:k,S=o.findAllMatches,A=S===void 0?_.findAllMatches:S,$=o.minMatchCharLength,E=$===void 0?_.minMatchCharLength:$,O=o.isCaseSensitive,N=O===void 0?_.isCaseSensitive:O,R=o.ignoreLocation,T=R===void 0?_.ignoreLocation:R;return u(this,e),a=n.call(this,r),a._bitapSearch=new Ee(r,{location:h,threshold:x,distance:M,includeMatches:w,findAllMatches:A,minMatchCharLength:E,isCaseSensitive:N,ignoreLocation:T}),a}return f(e,[{key:"search",value:function(a){return this._bitapSearch.searchIn(a)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),e})(U),Oe=(function(t){m(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){for(var o=0,d,h=[],p=this.pattern.length;(d=a.indexOf(this.pattern,o))>-1;)o=d+p,h.push([d,o-1]);var x=!!h.length;return{isMatch:x,score:x?0:1,indices:h}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),e})(U),pe=[vt,Oe,bt,xt,Mt,kt,yt,Pe],Te=pe.length,_t=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,wt="|";function Lt(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t.split(wt).map(function(e){for(var r=e.trim().split(_t).filter(function(S){return S&&!!S.trim()}),a=[],o=0,d=r.length;o<d;o+=1){for(var h=r[o],p=!1,x=-1;!p&&++x<Te;){var v=pe[x],M=v.isMultiMatch(h);M&&(a.push(new v(M,n)),p=!0)}if(!p)for(x=-1;++x<Te;){var k=pe[x],w=k.isSingleMatch(h);if(w){a.push(new k(w,n));break}}}return a})}var St=new Set([Pe.type,Oe.type]),It=(function(){function t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.isCaseSensitive,a=r===void 0?_.isCaseSensitive:r,o=e.includeMatches,d=o===void 0?_.includeMatches:o,h=e.minMatchCharLength,p=h===void 0?_.minMatchCharLength:h,x=e.ignoreLocation,v=x===void 0?_.ignoreLocation:x,M=e.findAllMatches,k=M===void 0?_.findAllMatches:M,w=e.location,S=w===void 0?_.location:w,A=e.threshold,$=A===void 0?_.threshold:A,E=e.distance,O=E===void 0?_.distance:E;u(this,t),this.query=null,this.options={isCaseSensitive:a,includeMatches:d,minMatchCharLength:p,findAllMatches:k,ignoreLocation:v,location:S,threshold:$,distance:O},this.pattern=a?n:n.toLowerCase(),this.query=Lt(this.pattern,this.options)}return f(t,[{key:"searchIn",value:function(e){var r=this.query;if(!r)return{isMatch:!1,score:1};var a=this.options,o=a.includeMatches,d=a.isCaseSensitive;e=d?e:e.toLowerCase();for(var h=0,p=[],x=0,v=0,M=r.length;v<M;v+=1){var k=r[v];p.length=0,h=0;for(var w=0,S=k.length;w<S;w+=1){var A=k[w],$=A.search(e),E=$.isMatch,O=$.indices,N=$.score;if(E){if(h+=1,x+=N,o){var R=A.constructor.type;St.has(R)?p=[].concat(F(p),F(O)):p.push(O)}}else{x=0,h=0,p.length=0;break}}if(h){var T={isMatch:!0,score:x/h};return o&&(T.indices=p),T}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(e,r){return r.useExtendedSearch}}]),t})(),re=[];function $t(){re.push.apply(re,arguments)}function me(t,n){for(var e=0,r=re.length;e<r;e+=1){var a=re[e];if(a.condition(t,n))return new a(t,n)}return new Ee(t,n)}var ie={AND:"$and",OR:"$or"},ve={PATH:"$path",PATTERN:"$val"},ye=function(n){return!!(n[ie.AND]||n[ie.OR])},At=function(n){return!!n[ve.PATH]},Ct=function(n){return!K(n)&&Le(n)&&!ye(n)},Ne=function(n){return l({},ie.AND,Object.keys(n).map(function(e){return l({},e,n[e])}))};function Fe(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.auto,a=r===void 0?!0:r,o=function d(h){var p=Object.keys(h),x=At(h);if(!x&&p.length>1&&!ye(h))return d(Ne(h));if(Ct(h)){var v=x?h[ve.PATH]:p[0],M=x?h[ve.PATTERN]:h[v];if(!H(M))throw new Error(tt(v));var k={keyId:fe(v),pattern:M};return a&&(k.searcher=me(M,n)),k}var w={children:[],operator:p[0]};return p.forEach(function(S){var A=h[S];K(A)&&A.forEach(function($){w.children.push(d($))})}),w};return ye(t)||(t=Ne(t)),o(t)}function Et(t,n){var e=n.ignoreFieldNorm,r=e===void 0?_.ignoreFieldNorm:e;t.forEach(function(a){var o=1;a.matches.forEach(function(d){var h=d.key,p=d.norm,x=d.score,v=h?h.weight:null;o*=Math.pow(x===0&&v?Number.EPSILON:x,(v||1)*(r?1:p))}),a.score=o})}function Rt(t,n){var e=t.matches;n.matches=[],D(e)&&e.forEach(function(r){if(!(!D(r.indices)||!r.indices.length)){var a=r.indices,o=r.value,d={indices:a,value:o};r.key&&(d.key=r.key.src),r.idx>-1&&(d.refIndex=r.idx),n.matches.push(d)}})}function Pt(t,n){n.score=t.score}function Ot(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.includeMatches,a=r===void 0?_.includeMatches:r,o=e.includeScore,d=o===void 0?_.includeScore:o,h=[];return a&&h.push(Rt),d&&h.push(Pt),t.map(function(p){var x=p.idx,v={item:n[x],refIndex:x};return h.length&&h.forEach(function(M){M(p,v)}),v})}var X=(function(){function t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;u(this,t),this.options=i(i({},_),e),this.options.useExtendedSearch,this._keyStore=new st(this.options.keys),this.setCollection(n,r)}return f(t,[{key:"setCollection",value:function(e,r){if(this._docs=e,r&&!(r instanceof ge))throw new Error(et);this._myIndex=r||Ce(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}},{key:"add",value:function(e){D(e)&&(this._docs.push(e),this._myIndex.add(e))}},{key:"remove",value:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){return!1},r=[],a=0,o=this._docs.length;a<o;a+=1){var d=this._docs[a];e(d,a)&&(this.removeAt(a),a-=1,o-=1,r.push(d))}return r}},{key:"removeAt",value:function(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.limit,o=a===void 0?-1:a,d=this.options,h=d.includeMatches,p=d.includeScore,x=d.shouldSort,v=d.sortFn,M=d.ignoreFieldNorm,k=H(e)?H(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Et(k,{ignoreFieldNorm:M}),x&&k.sort(v),we(o)&&o>-1&&(k=k.slice(0,o)),Ot(k,this._docs,{includeMatches:h,includeScore:p})}},{key:"_searchStringList",value:function(e){var r=me(e,this.options),a=this._myIndex.records,o=[];return a.forEach(function(d){var h=d.v,p=d.i,x=d.n;if(D(h)){var v=r.searchIn(h),M=v.isMatch,k=v.score,w=v.indices;M&&o.push({item:h,idx:p,matches:[{score:k,value:h,norm:x,indices:w}]})}}),o}},{key:"_searchLogical",value:function(e){var r=this,a=Fe(e,this.options),o=function x(v,M,k){if(!v.children){var w=v.keyId,S=v.searcher,A=r._findMatches({key:r._keyStore.get(w),value:r._myIndex.getValueForItemAtKeyId(M,w),searcher:S});return A&&A.length?[{idx:k,item:M,matches:A}]:[]}for(var $=[],E=0,O=v.children.length;E<O;E+=1){var N=v.children[E],R=x(N,M,k);if(R.length)$.push.apply($,F(R));else if(v.operator===ie.AND)return[]}return $},d=this._myIndex.records,h={},p=[];return d.forEach(function(x){var v=x.$,M=x.i;if(D(v)){var k=o(a,v,M);k.length&&(h[M]||(h[M]={idx:M,item:v,matches:[]},p.push(h[M])),k.forEach(function(w){var S,A=w.matches;(S=h[M].matches).push.apply(S,F(A))}))}}),p}},{key:"_searchObjectList",value:function(e){var r=this,a=me(e,this.options),o=this._myIndex,d=o.keys,h=o.records,p=[];return h.forEach(function(x){var v=x.$,M=x.i;if(D(v)){var k=[];d.forEach(function(w,S){k.push.apply(k,F(r._findMatches({key:w,value:v[S],searcher:a})))}),k.length&&p.push({idx:M,item:v,matches:k})}}),p}},{key:"_findMatches",value:function(e){var r=e.key,a=e.value,o=e.searcher;if(!D(a))return[];var d=[];if(K(a))a.forEach(function(w){var S=w.v,A=w.i,$=w.n;if(D(S)){var E=o.searchIn(S),O=E.isMatch,N=E.score,R=E.indices;O&&d.push({score:N,key:r,value:S,idx:A,norm:$,indices:R})}});else{var h=a.v,p=a.n,x=o.searchIn(h),v=x.isMatch,M=x.score,k=x.indices;v&&d.push({score:M,key:r,value:h,norm:p,indices:k})}return d}}]),t})();X.version="7.0.0",X.createIndex=Ce,X.parseIndex=ft,X.config=_,X.parseQuery=Fe,$t(It);var Tt=X;return Tt}))});var Qt={};Ut(Qt,{AssistantController:()=>ue,AssistantEngine:()=>te});module.exports=Vt(Qt);var Ke=Gt(ze()),te=class{constructor(i,s=Ke.default,u={}){this.searchData=i,this.Fuse=s,this.config={phoneticMap:{},semanticMap:{},stopWords:[],entityDefinitions:{},intentRules:[],...u},this.history={lastCategory:null,detectedEntities:new Set},this.initFuse()}initFuse(){this.Fuse&&(this.fuse=new this.Fuse(this.searchData,{keys:[{name:"title",weight:.8},{name:"keywords",weight:.5},{name:"description",weight:.2}],threshold:.45,includeScore:!0,useExtendedSearch:!0}))}autoCorrect(i){if(!this.config.phoneticMap)return i;for(let[s,u]of Object.entries(this.config.phoneticMap))if(u.includes(i))return s;return i}preprocess(i){let s={isQuestion:i.includes("?"),isUrgent:i.includes("!")},u=new Set(this.config.stopWords||[]),l=i.toLowerCase().replace(/[^\w\s]/g,"").split(/\s+/).filter(b=>b.length>1).map(b=>this.autoCorrect(b)),m=l.map(b=>this.stemIndonesian(b)),g=[...new Set([...l,...m])].filter(b=>!u.has(b)),I=[];return g.forEach(b=>{this.config.semanticMap&&this.config.semanticMap[b]&&I.push(...this.config.semanticMap[b]);let L=this.stemIndonesian(b);L!==b&&this.config.semanticMap&&this.config.semanticMap[L]&&I.push(...this.config.semanticMap[L])}),{tokens:g,expanded:[...new Set([...g,...I])],entities:this.extractEntities(g),signals:s}}extractEntities(i){let s={};if(this.config.entityDefinitions)for(let[u,c]of Object.entries(this.config.entityDefinitions)){let f=i.some(l=>c.includes(l));s[u]=f,f&&this.history.detectedEntities.add(u)}return s}async search(i){if(this.config.searchMode==="remote"&&this.config.apiUrl)try{let g=Array.isArray(this.config.apiUrl)?this.config.apiUrl:[this.config.apiUrl],b=(await Promise.all(g.map(async L=>{try{return await(await fetch(`${L}?q=${encodeURIComponent(i)}`,{headers:this.config.apiHeaders||{}})).json()}catch(C){return console.error(`Remote fetch failed for ${L}:`,C),{results:[],intent:"fuzzy",entities:{}}}}))).reduce((L,C)=>(L.results.push(...C.results||[]),C.intent&&C.intent!=="fuzzy"&&(L.intent=C.intent),L.entities={...L.entities,...C.entities||{}},L),{results:[],intent:"fuzzy",entities:{},confidence:0});if(b.results.length>0){let L=this.preprocess(i),C=b.results.map(F=>({item:F,score:this.calculateScore(F,L,.5)})).sort((F,J)=>J.score-F.score);return{...b,results:C.map(F=>F.item).slice(0,5),confidence:Math.min(Math.round(C[0].score*2),100)}}}catch(g){console.error("Remote search orchestration failed, falling back to local:",g)}let s=this.preprocess(i),u=[];this.fuse&&(u=this.fuse.search(s.expanded.join(" | ")).map(I=>({item:I.item,fuseScore:I.score})));let c=u.map(g=>{let I=this.calculateScore(g.item,s,g.fuseScore);return{item:g.item,score:I}});c.sort((g,I)=>I.score-g.score),c.length>0&&(this.history.lastCategory=c[0].item.category);let f=this.detectIntent(s),l=f.startsWith("chat_"),m="";f==="chat_greeting"?m=this.config.fallbackIntentResponses?.chat_greeting||"Halo! Ada yang bisa saya bantu hari ini? Anda bisa tanya tentang produk, harga, atau promo kami.":f==="chat_thanks"&&(m=this.config.fallbackIntentResponses?.chat_thanks||"Sama-sama! Senang bisa membantu. Ada lagi yang ingin ditanyakan?");let y=c.filter(g=>g.score>10||l&&g.score>5).map(g=>g.item).slice(0,5);return{results:y,intent:f,entities:s.entities,confidence:c.length>0?Math.min(Math.round(c[0].score*2),100):l?80:0,answer:m||y[0]?.answer||""}}calculateDiceCoefficient(i,s){let u=m=>{let y=new Set;for(let g=0;g<m.length-1;g++)y.add(m.substring(g,g+2));return y};if(i===s)return 1;if(i.length<2||s.length<2)return 0;let c=u(i),f=u(s),l=0;for(let m of c)f.has(m)&&l++;return 2*l/(c.size+f.size)}stemIndonesian(i){let s=i.toLowerCase(),u=["lah","kah","pun","ku","mu","nya"];for(let l of u)if(s.endsWith(l)&&s.length>l.length+3){s=s.slice(0,-l.length);break}let c=["kan","an","i"];for(let l of c)if(s.endsWith(l)&&s.length>l.length+3){if(l==="i"&&s.endsWith("ti"))continue;s=s.slice(0,-l.length);break}let f=["memper","pember","penge","peng","peny","pen","pem","per","pe","ber","be","ter","te","me","di","ke","se"];for(let l of f)if(s.startsWith(l)&&s.length>l.length+3){l==="mem"&&"aiueo".includes(s[3])?s="p"+s.slice(3):l==="men"&&"aiueo".includes(s[3])?s="t"+s.slice(3):l==="meng"&&"aiueo".includes(s[4])?s="k"+s.slice(4):l==="meny"&&"aiueo".includes(s[4])?s="s"+s.slice(4):s=s.slice(l.length);break}return s}calculateScore(i,s,u){let c=(1-u)*10,f=i.title.toLowerCase(),l=i.description.toLowerCase(),m=(i.keywords||[]).map(b=>b.toLowerCase()),y=f+" "+m.join(" ")+" "+l;s.tokens.forEach((b,L)=>{y.includes(b)&&(c+=10,L>0&&y.includes(s.tokens[L-1]+" "+b)&&(c+=8));let C=this.calculateDiceCoefficient(b,f);C>.4&&(c+=C*15)}),s.tokens.forEach(b=>{f.includes(b)&&(c+=20),i.category.toLowerCase().includes(b)&&(c+=25),m.includes(b)&&(c+=15)});let g=this.calculateDiceCoefficient(s.tokens.join(""),f.replace(/\s/g,""));return g>.3&&(c+=g*40),this.history.lastCategory===i.category&&(c+=10),i.is_recommended&&(c+=25),s.signals?.isQuestion&&(i.answer&&(c+=15),(i.category.toLowerCase().includes("layanan")||i.category.toLowerCase().includes("syarat"))&&(c+=5)),s.signals?.isUrgent&&(c+=10),this.detectIntent(s).startsWith("sales_")&&((i.price_numeric||i.sale_price)&&(c+=30),i.badge_text&&(c+=15),(i.category.toLowerCase().includes("produk")||i.category.toLowerCase().includes("layanan"))&&(c+=20)),c}detectIntent(i){let u={...{beli:["beli","pesan","ambil","order","checkout","booking","buy","purchase","get"],harga:["harga","biaya","price","budget","bayar","cicilan","dp","murah","cost","payment","cheap"],promo:["promo","diskon","discount","sale","hemat","bonus","voucher","off"]},...this.config.salesTriggers||{}},c=i.tokens.map(m=>this.stemIndonesian(m));for(let[m,y]of Object.entries(u))if(y.some(g=>c.includes(g)||i.tokens.includes(g)))return`sales_${m}`;let l={...{greeting:["halo","halo","hi","helo","hey","pagi","siang","sore","malam","assalamualaikum","permisi","hello"],thanks:["terima kasih","thanks","tq","syukron","makasih","oke","sip","mantap"]},...this.config.conversationTriggers||{}};for(let[m,y]of Object.entries(l))if(y.some(g=>c.includes(g)||i.tokens.includes(g)))return`chat_${m}`;if(!this.config.intentRules)return"fuzzy";for(let m of this.config.intentRules){let y=!m.conditions.entities||m.conditions.entities.some(I=>i.entities[I]),g=!m.conditions.tokens||m.conditions.tokens.some(I=>i.tokens.includes(I)||c.includes(I));if(y&&g)return m.intent}return"fuzzy"}getComparisonTriggers(){let i=["bandingkan","banding","perbandingan","beda","perbedaan","lebih bagus","lebih baik","mana yang","pilih mana","vs","versus","dibanding","ketimbang","daripada","compare","comparison","difference","which is better","versus","vs","differ","choose between","better than","compared to"];return this.config.comparisonTriggers||i}getComparisonLabels(){return{...{title:"Produk",price:"Harga",recommendation:"\u{1F3C6} Rekomendasi",bestChoice:"Pilihan Terbaik",reasons:"Alasan",noProducts:"Tidak ada produk untuk dibandingkan.",vsLabel:"vs"},...this.config.comparisonLabels||{}}}isComparisonQuery(i){let s=this.getComparisonTriggers(),u=i.toLowerCase();return s.some(c=>u.includes(c))}extractAttributes(i){let s={},u=(i.description||"").toLowerCase(),f=`${(i.title||"").toLowerCase()} ${u}`,m={...{harga:/(?:harga|price|biaya)[:\s]*(?:rp\.?|idr)?\s*([\d.,]+)/i,kapasitas:/(?:kapasitas|capacity)[:\s]*([\d.,]+\s*(?:gb|mb|tb|liter|kg|gram|ml|l|g))/i,kecepatan:/(?:kecepatan|speed)[:\s]*([\d.,]+\s*(?:mbps|gbps|rpm|mhz|ghz))/i,garansi:/(?:garansi|warranty)[:\s]*([\d]+\s*(?:tahun|bulan|year|month|hari|day)s?)/i,rating:/(?:rating|bintang|star)[:\s]*([\d.,]+)/i,material:/(?:bahan|material)[:\s]*([a-zA-Z\s]+?)(?:\.|,|$)/i,warna:/(?:warna|color|colour)[:\s]*([a-zA-Z\s]+?)(?:\.|,|$)/i,ukuran:/(?:ukuran|size|dimensi|dimension)[:\s]*([\d.,x\s]+(?:cm|mm|m|inch)?)/i}};if(this.config.attributeExtractors)for(let[I,b]of Object.entries(this.config.attributeExtractors))m[I]=typeof b=="string"?new RegExp(b,"i"):b;for(let[I,b]of Object.entries(m)){let L=f.match(b);L&&L[1]&&(s[I]=L[1].trim())}i.price_numeric&&(s.harga=i.price_numeric),i.sale_price&&(s.harga_promo=i.sale_price),i.badge_text&&(s.badge=i.badge_text),i.is_recommended&&(s.direkomendasikan=!0);let y=[/(?:fitur|feature|keunggulan|kelebihan)[:\s]*([^.]+)/gi,/(?:•|▪|★|✓|✔|-)([^•▪★✓✔\-\n]+)/g],g=[];for(let I of y){let b;for(;(b=I.exec(f))!==null;){let L=b[1].trim();L.length>3&&L.length<100&&g.push(L)}}return g.length>0&&(s.fitur=g.slice(0,5).join("; ")),s}calculateComparisonScore(i,s){let u=0;if(i.sale_price&&i.price_numeric){let f=(i.price_numeric-i.sale_price)/i.price_numeric*100;u+=Math.min(f,50)}if(i.is_recommended&&(u+=30),i.badge_text){let f=i.badge_text.toLowerCase();(f.includes("best")||f.includes("terbaik"))&&(u+=25),(f.includes("popular")||f.includes("populer"))&&(u+=20),(f.includes("new")||f.includes("baru"))&&(u+=15),(f.includes("sale")||f.includes("promo"))&&(u+=15)}let c=Object.keys(s).length;if(u+=Math.min(c*5,25),s.rating){let f=parseFloat(String(s.rating));isNaN(f)||(u+=f*5)}if(s.garansi){let f=String(s.garansi).match(/(\d+)/);if(f){let l=parseInt(f[1]);u+=Math.min(l*10,30)}}return u}generateReasons(i,s){let u=[],c=this.getComparisonLabels();if(i.salePrice&&i.price){let y=Math.round((i.price-i.salePrice)/i.price*100);u.push(`Diskon ${y}% dari harga normal`)}let f=s.filter(y=>y.price||y.salePrice).map(y=>y.salePrice||y.price||1/0);(i.salePrice||i.price||1/0)===Math.min(...f)&&f.length>1&&u.push("Harga paling terjangkau");let m=s.map(y=>Object.keys(y.attributes).length);return Object.keys(i.attributes).length===Math.max(...m)&&m.length>1&&u.push("Fitur paling lengkap"),i.attributes.garansi&&u.push(`Garansi: ${i.attributes.garansi}`),i.isRecommended&&u.push("Direkomendasikan oleh tim kami"),u.slice(0,4)}generateTableHtml(i,s){let u=this.getComparisonLabels();if(i.length===0)return`<p>${u.noProducts}</p>`;let c='<table class="comparison-table" style="width:100%;border-collapse:collapse;font-size:14px;">';c+='<thead><tr style="background:#f5f5f5;">',c+=`<th style="padding:12px;border:1px solid #ddd;text-align:left;">${u.title}</th>`;for(let l of i){let m=l.isRecommended?" \u2B50":"";c+=`<th style="padding:12px;border:1px solid #ddd;text-align:center;">${l.title}${m}</th>`}if(c+="</tr></thead>",c+="<tbody>",i.some(l=>l.price||l.salePrice)){c+="<tr>",c+=`<td style="padding:10px;border:1px solid #ddd;font-weight:bold;">${u.price}</td>`;for(let l of i){let m="-";l.salePrice&&l.price&&l.salePrice<l.price?m=`<span style="text-decoration:line-through;color:#999;">Rp ${l.price.toLocaleString("id-ID")}</span><br><span style="color:#e53935;font-weight:bold;">Rp ${l.salePrice.toLocaleString("id-ID")}</span>`:l.price?m=`Rp ${l.price.toLocaleString("id-ID")}`:l.salePrice&&(m=`<span style="color:#e53935;font-weight:bold;">Rp ${l.salePrice.toLocaleString("id-ID")}</span>`),c+=`<td style="padding:10px;border:1px solid #ddd;text-align:center;">${m}</td>`}c+="</tr>"}for(let l of s)if(!(l==="harga"||l==="harga_promo")){c+="<tr>",c+=`<td style="padding:10px;border:1px solid #ddd;font-weight:bold;">${this.formatAttributeLabel(l)}</td>`;for(let m of i){let y=m.attributes[l],g="-";y!=null&&(typeof y=="boolean"?g=y?"\u2713":"\u2717":g=String(y)),c+=`<td style="padding:10px;border:1px solid #ddd;text-align:center;">${g}</td>`}c+="</tr>"}return c+="</tbody></table>",c}generateTableMarkdown(i,s){let u=this.getComparisonLabels();if(i.length===0)return u.noProducts;let c="";c+=`| ${u.title} |`;for(let l of i){let m=l.isRecommended?" \u2B50":"";c+=` ${l.title}${m} |`}c+=`
`,c+="|---|";for(let l=0;l<i.length;l++)c+="---|";if(c+=`
`,i.some(l=>l.price||l.salePrice)){c+=`| **${u.price}** |`;for(let l of i)l.salePrice&&l.price&&l.salePrice<l.price?c+=` ~~Rp ${l.price.toLocaleString("id-ID")}~~ **Rp ${l.salePrice.toLocaleString("id-ID")}** |`:l.price?c+=` Rp ${l.price.toLocaleString("id-ID")} |`:l.salePrice?c+=` **Rp ${l.salePrice.toLocaleString("id-ID")}** |`:c+=" - |";c+=`
`}for(let l of s)if(!(l==="harga"||l==="harga_promo")){c+=`| **${this.formatAttributeLabel(l)}** |`;for(let m of i){let y=m.attributes[l],g="-";y!=null&&(typeof y=="boolean"?g=y?"\u2713":"\u2717":g=String(y)),c+=` ${g} |`}c+=`
`}return c}formatAttributeLabel(i){return{harga:"Harga",harga_promo:"Harga Promo",kapasitas:"Kapasitas",kecepatan:"Kecepatan",garansi:"Garansi",rating:"Rating",material:"Material",warna:"Warna",ukuran:"Ukuran",fitur:"Fitur",badge:"Badge",direkomendasikan:"Rekomendasi"}[i]||i.charAt(0).toUpperCase()+i.slice(1)}async compareProducts(i,s,u=4){let c=[];if(s?c=this.searchData.filter(b=>b.category.toLowerCase().includes(s.toLowerCase())):c=(await this.search(i)).results,c.length===0){let b=this.preprocess(i);for(let L of this.searchData){let C=L.title.toLowerCase(),F=L.category.toLowerCase();b.tokens.some(J=>C.includes(J)||F.includes(J))&&c.push(L)}}c.length===0&&(c=[...this.searchData]),c=c.slice(0,u);let f=c.map(b=>{let L=this.extractAttributes(b),C=this.calculateComparisonScore(b,L);return{title:b.title,attributes:L,score:C,isRecommended:b.is_recommended||!1,url:b.url,price:b.price_numeric,salePrice:b.sale_price}});f.sort((b,L)=>L.score-b.score);let l=new Set;for(let b of f)for(let L of Object.keys(b.attributes))l.add(L);let m=Array.from(l),y=null;if(f.length>0){let b=f[0],L=this.generateReasons(b,f);y={item:b,reasons:L}}let g=this.generateTableHtml(f,m),I=this.generateTableMarkdown(f,m);return{items:f,attributeLabels:m,recommendation:y,tableHtml:g,tableMarkdown:I}}async searchWithComparison(i){let s=await this.search(i);if(this.isComparisonQuery(i)){let u=await this.compareProducts(i),c=this.getComparisonLabels(),f="";if(u.recommendation){if(f=`${c.recommendation}: **${u.recommendation.item.title}**

`,u.recommendation.reasons.length>0){f+=`${c.reasons}:
`;for(let l of u.recommendation.reasons)f+=`\u2022 ${l}
`}f+=`
${u.tableMarkdown}`}else f=c.noProducts;return{...s,intent:"comparison",answer:f,comparison:u}}return s}};var ue=class{constructor(i,s=void 0,u={},c={}){this.elements={};this.chatHistory=[];this.interactionCount=0;this.engine=new te(i,s,c),this.selectors=u,this.config=c,this.initElements(),this.initEventListeners(),this.loadHistory()}initElements(){this.elements.overlay=document.getElementById(this.selectors.overlayId),this.elements.input=document.getElementById(this.selectors.inputId),this.elements.sendBtn=document.getElementById(this.selectors.sendBtnId),this.elements.closeBtn=document.getElementById(this.selectors.closeBtnId),this.elements.chatContainer=document.getElementById(this.selectors.chatContainerId),this.elements.messagesList=document.getElementById(this.selectors.messagesListId),this.elements.typingIndicator=document.getElementById(this.selectors.typingIndicatorId),this.elements.welcomeMsg=document.querySelector(`.${this.selectors.welcomeMsgClass}`)}initEventListeners(){let i=this.elements.input;i&&i.addEventListener("keydown",s=>{s.key==="Enter"&&this.performAction()}),this.elements.sendBtn&&this.elements.sendBtn.addEventListener("click",()=>this.performAction()),this.elements.closeBtn&&this.elements.closeBtn.addEventListener("click",()=>this.closeAssistant()),document.querySelectorAll(`.${this.selectors.quickLinksClass}`).forEach(s=>{let u=s;u.addEventListener("click",()=>{i&&u.dataset.query&&(i.value=u.dataset.query,this.performAction())})}),document.addEventListener("keydown",s=>{s.key==="Escape"&&this.elements.overlay&&!this.elements.overlay.classList.contains("hidden")&&this.closeAssistant(),(s.metaKey||s.ctrlKey)&&s.key==="k"&&(s.preventDefault(),this.openAssistant())}),this.elements.overlay&&this.elements.overlay.addEventListener("click",s=>{s.target===this.elements.overlay&&this.closeAssistant()})}openAssistant(){let i=this.elements.overlay,s=this.elements.input;!i||!s||(i.classList.remove("hidden"),setTimeout(()=>{i.classList.remove("opacity-0"),s.focus(),this.elements.welcomeMsg&&this.elements.welcomeMsg.classList.remove("opacity-0","translate-y-4")},10),document.body.style.overflow="hidden")}closeAssistant(){let i=this.elements.overlay,s=this.elements.input;!i||!s||(i.classList.add("opacity-0"),setTimeout(()=>{i.classList.add("hidden"),s.value=""},300),document.body.style.overflow="")}performAction(){let i=this.elements.input;if(!i)return;let s=i.value;s.trim()&&(i.value="",this.addUserMessage(s),this.showTyping(),setTimeout(async()=>{this.hideTyping();let u=await this.engine.searchWithComparison(s);this.addAssistantMessage(s,u)},1e3))}showTyping(){let i=this.elements.typingIndicator;i&&(i.classList.remove("hidden"),setTimeout(()=>i.classList.remove("opacity-0"),10),this.scrollToBottom())}hideTyping(){let i=this.elements.typingIndicator;i&&(i.classList.add("opacity-0"),setTimeout(()=>i.classList.add("hidden"),300))}scrollToBottom(){let i=this.elements.chatContainer;i&&i.scrollTo({top:i.scrollHeight,behavior:"smooth"})}addUserMessage(i,s=!0){if(!this.elements.messagesList)return;let u=document.createElement("div");u.className="bubble-container user opacity-0 translate-y-4 bubble-user",u.innerHTML=`
            <div class="bg-gradient-to-br from-primary to-primary-dark text-white p-5 rounded-3xl rounded-tr-none shadow-xl max-w-[85%] border border-white/10">
                <p class="text-sm md:text-base font-semibold tracking-tight">${i}</p>
            </div>`,this.elements.messagesList.appendChild(u),s&&(this.chatHistory.push({type:"user",text:i}),this.saveHistory())}addAssistantMessage(i,s,u=!0){if(!this.elements.messagesList)return;this.interactionCount++,u&&(this.chatHistory.push({type:"assistant",text:i,result:s}),this.saveHistory());let c=document.createElement("div");c.className="bubble-container assistant opacity-0 translate-y-4 bubble-assistant";let f=this.generateResponseHTML(i,s);c.innerHTML=`
            <div class="w-11 h-11 rounded-2xl bg-white flex items-center justify-center text-primary shrink-0 shadow-lg border border-gray-100 hidden md:flex">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                </svg>
            </div>
            <div class="space-y-3 max-w-[92%] md:max-w-[85%]">
                <div class="bg-white/80 backdrop-blur-md p-6 rounded-3xl rounded-tl-none shadow-2xl border border-white/40 text-dark leading-relaxed">
                    ${f}
                </div>
            </div>`,this.elements.messagesList.appendChild(c),this.scrollToBottom()}generateResponseHTML(i,s){let{results:u,confidence:c,answer:f,comparison:l}=s,m="";if(l&&l.items&&l.items.length>0)return l.recommendation&&(m+=`<div class="mb-4 p-4 bg-gradient-to-r from-primary/10 to-accent/10 rounded-2xl border border-primary/20">
                    <p class="text-xs uppercase tracking-wider text-primary font-bold mb-2">\u{1F3C6} Rekomendasi Kami</p>
                    <p class="text-base font-bold text-dark">${l.recommendation.item.title}</p>
                    ${l.recommendation.reasons.length>0?`
                        <ul class="mt-2 text-xs text-gray-600 list-disc list-inside">
                            ${l.recommendation.reasons.map(y=>`<li>${y}</li>`).join("")}
                        </ul>
                    `:""}
                </div>`),m+=`<div class="overflow-x-auto mt-4">${l.tableHtml}</div>`,m+='<div class="flex flex-wrap gap-2 mt-4">',l.items.forEach((y,g)=>{let I=g===0;m+=`<a href="${y.url}" class="px-4 py-2 text-xs font-bold rounded-xl transition-all ${I?"bg-primary text-white hover:bg-primary-dark":"bg-gray-100 text-gray-700 hover:bg-gray-200"}">${y.title}</a>`}),m+="</div>",m;if(f)m+=`<p class="text-sm md:text-base font-medium mb-4">${this.formatText(f)}</p>`;else if(u.length>0){let y=u[0];m+=`<p class="text-sm md:text-base font-medium mb-4">${this.formatText(y.answer||y.description)}</p>`}if(u.length>0){let y=u.filter(g=>g.category!=="Sapaan").slice(0,3).map((g,I)=>{let b=I===0&&(g.price_numeric||g.sale_price||g.is_recommended),L=g.cta_label||(g.category.includes("Produk")||g.category.includes("Layanan")?"Pesan Sekarang":"Lihat Detail");return`
                <a href="${g.cta_url||g.url}" class="flex flex-col gap-3 p-5 ${b?"bg-primary/5 border-primary/40 shadow-lg ring-1 ring-primary/20":"bg-white/50 border-gray-100"} hover:bg-white hover:scale-[1.02] hover:shadow-2xl rounded-3xl border transition-all group w-full mb-3">
                    <div class="flex items-center justify-between">
                        <div class="flex flex-wrap gap-2">
                            <span class="text-[9px] font-black text-white bg-primary px-2 py-1 rounded-lg uppercase tracking-wider">${g.category}</span>
                            ${g.badge_text?`<span class="text-[9px] font-bold text-white bg-red-500 px-2 py-1 rounded-lg uppercase tracking-wider">${g.badge_text}</span>`:""}
                            ${g.is_recommended?'<span class="text-[9px] font-bold text-white bg-orange-500 px-2 py-1 rounded-lg uppercase tracking-wider animate-pulse">\u2728 Unggulan</span>':""}
                        </div>
                        ${g.price_numeric?`
                            <div class="text-right">
                                ${g.sale_price?`<span class="text-[10px] text-gray-400 line-through block">Rp ${(g.price_numeric/1e6).toFixed(1)}Jt</span>`:""}
                                <span class="text-sm font-extrabold text-primary">Rp ${((g.sale_price||g.price_numeric)/1e6).toFixed(1)}Jt</span>
                            </div>
                        `:""}
                    </div>
                    <h4 class="font-extrabold text-dark text-base leading-tight group-hover:text-primary transition-colors">${g.title}</h4>
                    <p class="text-[12px] text-gray-500 line-clamp-2 leading-relaxed">${g.description}</p>
                    <div class="flex items-center justify-end mt-2 pt-2 border-t border-gray-50">
                        <span class="bg-primary/10 text-primary px-3 py-1.5 rounded-xl text-[10px] font-bold flex items-center gap-1.5 group-hover:bg-primary group-hover:text-white transition-all">
                            ${L}
                            <svg class="w-2.5 h-2.5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"></path></svg>
                        </span>
                    </div>
                </a>`}).join("");y&&(m+=`<div class="mt-4">${y}</div>`)}else f||(m='<p class="flex items-center gap-2 text-gray-400 italic text-sm"><svg class="w-4 h-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> Maaf, saya belum menemukan jawaban yang pas. Silakan hubungi admin kami via WhatsApp.</p>',this.config.whatsappNumber&&setTimeout(()=>{let y=`https://wa.me/${this.config.whatsappNumber}?text=${encodeURIComponent("Halo, saya ingin bertanya tentang: "+i)}`;window.open(y,"_blank")},2e3));return m}formatText(i){return i.replace(/\*\*(.*?)\*\*/g,'<span class="font-bold text-primary">$1</span>')}saveHistory(){localStorage.setItem("assistant_chat_history",JSON.stringify(this.chatHistory))}loadHistory(){let i=localStorage.getItem("assistant_chat_history");if(i)try{this.chatHistory=JSON.parse(i),this.chatHistory.forEach(s=>{s.type==="user"?this.addUserMessage(s.text,!1):s.type==="assistant"&&s.result&&this.addAssistantMessage(s.text,s.result,!1)})}catch(s){console.error("History load error",s)}}};0&&(module.exports={AssistantController,AssistantEngine});
