"use strict";var Assistant=(()=>{var Dt=Object.create;var le=Object.defineProperty;var Ht=Object.getOwnPropertyDescriptor;var Wt=Object.getOwnPropertyNames;var Bt=Object.getPrototypeOf,zt=Object.prototype.hasOwnProperty;var Kt=(O,i)=>()=>(i||O((i={exports:{}}).exports,i),i.exports),Ut=(O,i)=>{for(var s in i)le(O,s,{get:i[s],enumerable:!0})},Be=(O,i,s,u)=>{if(i&&typeof i=="object"||typeof i=="function")for(let c of Wt(i))!zt.call(O,c)&&c!==s&&le(O,c,{get:()=>i[c],enumerable:!(u=Ht(i,c))||u.enumerable});return O};var Gt=(O,i,s)=>(s=O!=null?Dt(Bt(O)):{},Be(i||!O||!O.__esModule?le(s,"default",{value:O,enumerable:!0}):s,O)),Vt=O=>Be(le({},"__esModule",{value:!0}),O);var ze=Kt((ke,Me)=>{"use strict";(function(O,i){typeof ke=="object"&&typeof Me<"u"?Me.exports=i():typeof define=="function"&&define.amd?define(i):(O=typeof globalThis<"u"?globalThis:O||self,O.Fuse=i())})(ke,(function(){"use strict";function O(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,r)}return e}function i(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?O(Object(e),!0).forEach(function(r){l(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):O(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}function s(t){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},s(t)}function u(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function c(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_e(r.key),r)}}function f(t,n,e){return n&&c(t.prototype,n),e&&c(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,n,e){return n=_e(n),n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function v(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&x(t,n)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(t)}function x(t,n){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},x(t,n)}function I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(t,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}function C(t){var n=I();return function(){var r=p(t),a;if(n){var o=p(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return L(this,a)}}function F(t){return J(t)||Ue(t)||Ge(t)||Ve()}function J(t){if(Array.isArray(t))return he(t)}function Ue(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ge(t,n){if(t){if(typeof t=="string")return he(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return he(t,n)}}function he(t,n){(n==null||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Ve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qe(t,n){if(typeof t!="object"||t===null)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var r=e.call(t,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function _e(t){var n=Qe(t,"string");return typeof n=="symbol"?n:String(n)}function K(t){return Array.isArray?Array.isArray(t):Se(t)==="[object Array]"}var Ye=1/0;function Je(t){if(typeof t=="string")return t;var n=t+"";return n=="0"&&1/t==-Ye?"-0":n}function Xe(t){return t==null?"":Je(t)}function H(t){return typeof t=="string"}function we(t){return typeof t=="number"}function Ze(t){return t===!0||t===!1||qe(t)&&Se(t)=="[object Boolean]"}function Le(t){return s(t)==="object"}function qe(t){return Le(t)&&t!==null}function D(t){return t!=null}function de(t){return!t.trim().length}function Se(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}var Yt="Extended search is not available",et="Incorrect 'index' type",tt=function(n){return"Invalid value for key ".concat(n)},nt=function(n){return"Pattern length exceeds max of ".concat(n,".")},rt=function(n){return"Missing ".concat(n," property in key")},it=function(n){return"Property 'weight' in key '".concat(n,"' must be a positive integer")},Ie=Object.prototype.hasOwnProperty,st=(function(){function t(n){var e=this;u(this,t),this._keys=[],this._keyMap={};var r=0;n.forEach(function(a){var o=Ae(a);e._keys.push(o),e._keyMap[o.id]=o,r+=o.weight}),this._keys.forEach(function(a){a.weight/=r})}return f(t,[{key:"get",value:function(e){return this._keyMap[e]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),t})();function Ae(t){var n=null,e=null,r=null,a=1,o=null;if(H(t)||K(t))r=t,n=$e(t),e=fe(t);else{if(!Ie.call(t,"name"))throw new Error(rt("name"));var d=t.name;if(r=d,Ie.call(t,"weight")&&(a=t.weight,a<=0))throw new Error(it(d));n=$e(d),e=fe(d),o=t.getFn}return{path:n,id:e,weight:a,src:r,getFn:o}}function $e(t){return K(t)?t:t.split(".")}function fe(t){return K(t)?t.join("."):t}function at(t,n){var e=[],r=!1,a=function o(d,h,g){if(D(d))if(!h[g])e.push(d);else{var b=h[g],m=d[b];if(!D(m))return;if(g===h.length-1&&(H(m)||we(m)||Ze(m)))e.push(Xe(m));else if(K(m)){r=!0;for(var M=0,k=m.length;M<k;M+=1)o(m[M],h,g+1)}else h.length&&o(m,h,g+1)}};return a(t,H(n)?n.split("."):n,0),r?e:e[0]}var ot={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},ct={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(n,e){return n.score===e.score?n.idx<e.idx?-1:1:n.score<e.score?-1:1}},lt={location:0,threshold:.6,distance:100},ut={useExtendedSearch:!1,getFn:at,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},_=i(i(i(i({},ct),ot),lt),ut),ht=/[^ ]+/g;function dt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,e=new Map,r=Math.pow(10,n);return{get:function(o){var d=o.match(ht).length;if(e.has(d))return e.get(d);var h=1/Math.pow(d,.5*t),g=parseFloat(Math.round(h*r)/r);return e.set(d,g),g},clear:function(){e.clear()}}}var ge=(function(){function t(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.getFn,r=e===void 0?_.getFn:e,a=n.fieldNormWeight,o=a===void 0?_.fieldNormWeight:a;u(this,t),this.norm=dt(o,3),this.getFn=r,this.isCreated=!1,this.setIndexRecords()}return f(t,[{key:"setSources",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.docs=e}},{key:"setIndexRecords",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.records=e}},{key:"setKeys",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.keys=r,this._keysMap={},r.forEach(function(a,o){e._keysMap[a.id]=o})}},{key:"create",value:function(){var e=this;this.isCreated||!this.docs.length||(this.isCreated=!0,H(this.docs[0])?this.docs.forEach(function(r,a){e._addString(r,a)}):this.docs.forEach(function(r,a){e._addObject(r,a)}),this.norm.clear())}},{key:"add",value:function(e){var r=this.size();H(e)?this._addString(e,r):this._addObject(e,r)}},{key:"removeAt",value:function(e){this.records.splice(e,1);for(var r=e,a=this.size();r<a;r+=1)this.records[r].i-=1}},{key:"getValueForItemAtKeyId",value:function(e,r){return e[this._keysMap[r]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(e,r){if(!(!D(e)||de(e))){var a={v:e,i:r,n:this.norm.get(e)};this.records.push(a)}}},{key:"_addObject",value:function(e,r){var a=this,o={i:r,$:{}};this.keys.forEach(function(d,h){var g=d.getFn?d.getFn(e):a.getFn(e,d.path);if(D(g)){if(K(g)){for(var b=[],m=[{nestedArrIndex:-1,value:g}];m.length;){var M=m.pop(),k=M.nestedArrIndex,w=M.value;if(D(w))if(H(w)&&!de(w)){var S={v:w,i:k,n:a.norm.get(w)};b.push(S)}else K(w)&&w.forEach(function(A,E){m.push({nestedArrIndex:E,value:A})})}o.$[h]=b}else if(H(g)&&!de(g)){var $={v:g,n:a.norm.get(g)};o.$[h]=$}}}),this.records.push(o)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),t})();function Ce(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.getFn,a=r===void 0?_.getFn:r,o=e.fieldNormWeight,d=o===void 0?_.fieldNormWeight:o,h=new ge({getFn:a,fieldNormWeight:d});return h.setKeys(t.map(Ae)),h.setSources(n),h.create(),h}function ft(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=n.getFn,r=e===void 0?_.getFn:e,a=n.fieldNormWeight,o=a===void 0?_.fieldNormWeight:a,d=t.keys,h=t.records,g=new ge({getFn:r,fieldNormWeight:o});return g.setKeys(d),g.setIndexRecords(h),g}function ne(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=n.errors,r=e===void 0?0:e,a=n.currentLocation,o=a===void 0?0:a,d=n.expectedLocation,h=d===void 0?0:d,g=n.distance,b=g===void 0?_.distance:g,m=n.ignoreLocation,M=m===void 0?_.ignoreLocation:m,k=r/t.length;if(M)return k;var w=Math.abs(h-o);return b?k+w/b:w?1:k}function gt(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.minMatchCharLength,e=[],r=-1,a=-1,o=0,d=t.length;o<d;o+=1){var h=t[o];h&&r===-1?r=o:!h&&r!==-1&&(a=o-1,a-r+1>=n&&e.push([r,a]),r=-1)}return t[o-1]&&o-r>=n&&e.push([r,o-1]),e}var V=32;function pt(t,n,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=r.location,o=a===void 0?_.location:a,d=r.distance,h=d===void 0?_.distance:d,g=r.threshold,b=g===void 0?_.threshold:g,m=r.findAllMatches,M=m===void 0?_.findAllMatches:m,k=r.minMatchCharLength,w=k===void 0?_.minMatchCharLength:k,S=r.includeMatches,$=S===void 0?_.includeMatches:S,A=r.ignoreLocation,E=A===void 0?_.ignoreLocation:A;if(n.length>V)throw new Error(nt(V));for(var P=n.length,N=t.length,R=Math.max(0,Math.min(o,N)),T=b,j=R,W=w>1||$,Q=W?Array(N):[],B;(B=t.indexOf(n,j))>-1;){var je=ne(n,{currentLocation:B,expectedLocation:R,distance:h,ignoreLocation:E});if(T=Math.min(je,T),j=B+P,W)for(var Z=0;Z<P;)Q[B+Z]=1,Z+=1}j=-1;for(var q=[],se=1,ae=P+N,Nt=1<<P-1,Y=0;Y<P;Y+=1){for(var oe=0,G=ae;oe<G;){var Ft=ne(n,{errors:Y,currentLocation:R+G,expectedLocation:R,distance:h,ignoreLocation:E});Ft<=T?oe=G:ae=G,G=Math.floor((ae-oe)/2+oe)}ae=G;var De=Math.max(1,R-G+1),be=M?N:Math.min(R+G,N)+P,ee=Array(be+2);ee[be+1]=(1<<Y)-1;for(var z=be;z>=De;z-=1){var ce=z-1,He=e[t.charAt(ce)];if(W&&(Q[ce]=+!!He),ee[z]=(ee[z+1]<<1|1)&He,Y&&(ee[z]|=(q[z+1]|q[z])<<1|1|q[z+1]),ee[z]&Nt&&(se=ne(n,{errors:Y,currentLocation:ce,expectedLocation:R,distance:h,ignoreLocation:E}),se<=T)){if(T=se,j=ce,j<=R)break;De=Math.max(1,2*R-j)}}var jt=ne(n,{errors:Y+1,currentLocation:R,expectedLocation:R,distance:h,ignoreLocation:E});if(jt>T)break;q=ee}var xe={isMatch:j>=0,score:Math.max(.001,se)};if(W){var We=gt(Q,w);We.length?$&&(xe.indices=We):xe.isMatch=!1}return xe}function mt(t){for(var n={},e=0,r=t.length;e<r;e+=1){var a=t.charAt(e);n[a]=(n[a]||0)|1<<r-e-1}return n}var Ee=(function(){function t(n){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.location,o=a===void 0?_.location:a,d=r.threshold,h=d===void 0?_.threshold:d,g=r.distance,b=g===void 0?_.distance:g,m=r.includeMatches,M=m===void 0?_.includeMatches:m,k=r.findAllMatches,w=k===void 0?_.findAllMatches:k,S=r.minMatchCharLength,$=S===void 0?_.minMatchCharLength:S,A=r.isCaseSensitive,E=A===void 0?_.isCaseSensitive:A,P=r.ignoreLocation,N=P===void 0?_.ignoreLocation:P;if(u(this,t),this.options={location:o,threshold:h,distance:b,includeMatches:M,findAllMatches:w,minMatchCharLength:$,isCaseSensitive:E,ignoreLocation:N},this.pattern=E?n:n.toLowerCase(),this.chunks=[],!!this.pattern.length){var R=function(Z,q){e.chunks.push({pattern:Z,alphabet:mt(Z),startIndex:q})},T=this.pattern.length;if(T>V){for(var j=0,W=T%V,Q=T-W;j<Q;)R(this.pattern.substr(j,V),j),j+=V;if(W){var B=T-V;R(this.pattern.substr(B),B)}}else R(this.pattern,0)}}return f(t,[{key:"searchIn",value:function(e){var r=this.options,a=r.isCaseSensitive,o=r.includeMatches;if(a||(e=e.toLowerCase()),this.pattern===e){var d={isMatch:!0,score:0};return o&&(d.indices=[[0,e.length-1]]),d}var h=this.options,g=h.location,b=h.distance,m=h.threshold,M=h.findAllMatches,k=h.minMatchCharLength,w=h.ignoreLocation,S=[],$=0,A=!1;this.chunks.forEach(function(P){var N=P.pattern,R=P.alphabet,T=P.startIndex,j=pt(e,N,R,{location:g+T,distance:b,threshold:m,findAllMatches:M,minMatchCharLength:k,includeMatches:o,ignoreLocation:w}),W=j.isMatch,Q=j.score,B=j.indices;W&&(A=!0),$+=Q,W&&B&&(S=[].concat(F(S),F(B)))});var E={isMatch:A,score:A?$/this.chunks.length:1};return A&&o&&(E.indices=S),E}}]),t})(),U=(function(){function t(n){u(this,t),this.pattern=n}return f(t,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(e){return Re(e,this.multiRegex)}},{key:"isSingleMatch",value:function(e){return Re(e,this.singleRegex)}}]),t})();function Re(t,n){var e=t.match(n);return e?e[1]:null}var vt=(function(t){v(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=a===this.pattern;return{isMatch:o,score:o?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),e})(U),yt=(function(t){v(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=a.indexOf(this.pattern),d=o===-1;return{isMatch:d,score:d?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),e})(U),bt=(function(t){v(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=a.startsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),e})(U),xt=(function(t){v(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=!a.startsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),e})(U),kt=(function(t){v(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=a.endsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[a.length-this.pattern.length,a.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),e})(U),Mt=(function(t){v(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){var o=!a.endsWith(this.pattern);return{isMatch:o,score:o?0:1,indices:[0,a.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),e})(U),Oe=(function(t){v(e,t);var n=C(e);function e(r){var a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=o.location,h=d===void 0?_.location:d,g=o.threshold,b=g===void 0?_.threshold:g,m=o.distance,M=m===void 0?_.distance:m,k=o.includeMatches,w=k===void 0?_.includeMatches:k,S=o.findAllMatches,$=S===void 0?_.findAllMatches:S,A=o.minMatchCharLength,E=A===void 0?_.minMatchCharLength:A,P=o.isCaseSensitive,N=P===void 0?_.isCaseSensitive:P,R=o.ignoreLocation,T=R===void 0?_.ignoreLocation:R;return u(this,e),a=n.call(this,r),a._bitapSearch=new Ee(r,{location:h,threshold:b,distance:M,includeMatches:w,findAllMatches:$,minMatchCharLength:E,isCaseSensitive:N,ignoreLocation:T}),a}return f(e,[{key:"search",value:function(a){return this._bitapSearch.searchIn(a)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),e})(U),Pe=(function(t){v(e,t);var n=C(e);function e(r){return u(this,e),n.call(this,r)}return f(e,[{key:"search",value:function(a){for(var o=0,d,h=[],g=this.pattern.length;(d=a.indexOf(this.pattern,o))>-1;)o=d+g,h.push([d,o-1]);var b=!!h.length;return{isMatch:b,score:b?0:1,indices:h}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),e})(U),pe=[vt,Pe,bt,xt,Mt,kt,yt,Oe],Te=pe.length,_t=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,wt="|";function Lt(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t.split(wt).map(function(e){for(var r=e.trim().split(_t).filter(function(S){return S&&!!S.trim()}),a=[],o=0,d=r.length;o<d;o+=1){for(var h=r[o],g=!1,b=-1;!g&&++b<Te;){var m=pe[b],M=m.isMultiMatch(h);M&&(a.push(new m(M,n)),g=!0)}if(!g)for(b=-1;++b<Te;){var k=pe[b],w=k.isSingleMatch(h);if(w){a.push(new k(w,n));break}}}return a})}var St=new Set([Oe.type,Pe.type]),It=(function(){function t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.isCaseSensitive,a=r===void 0?_.isCaseSensitive:r,o=e.includeMatches,d=o===void 0?_.includeMatches:o,h=e.minMatchCharLength,g=h===void 0?_.minMatchCharLength:h,b=e.ignoreLocation,m=b===void 0?_.ignoreLocation:b,M=e.findAllMatches,k=M===void 0?_.findAllMatches:M,w=e.location,S=w===void 0?_.location:w,$=e.threshold,A=$===void 0?_.threshold:$,E=e.distance,P=E===void 0?_.distance:E;u(this,t),this.query=null,this.options={isCaseSensitive:a,includeMatches:d,minMatchCharLength:g,findAllMatches:k,ignoreLocation:m,location:S,threshold:A,distance:P},this.pattern=a?n:n.toLowerCase(),this.query=Lt(this.pattern,this.options)}return f(t,[{key:"searchIn",value:function(e){var r=this.query;if(!r)return{isMatch:!1,score:1};var a=this.options,o=a.includeMatches,d=a.isCaseSensitive;e=d?e:e.toLowerCase();for(var h=0,g=[],b=0,m=0,M=r.length;m<M;m+=1){var k=r[m];g.length=0,h=0;for(var w=0,S=k.length;w<S;w+=1){var $=k[w],A=$.search(e),E=A.isMatch,P=A.indices,N=A.score;if(E){if(h+=1,b+=N,o){var R=$.constructor.type;St.has(R)?g=[].concat(F(g),F(P)):g.push(P)}}else{b=0,h=0,g.length=0;break}}if(h){var T={isMatch:!0,score:b/h};return o&&(T.indices=g),T}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(e,r){return r.useExtendedSearch}}]),t})(),re=[];function At(){re.push.apply(re,arguments)}function me(t,n){for(var e=0,r=re.length;e<r;e+=1){var a=re[e];if(a.condition(t,n))return new a(t,n)}return new Ee(t,n)}var ie={AND:"$and",OR:"$or"},ve={PATH:"$path",PATTERN:"$val"},ye=function(n){return!!(n[ie.AND]||n[ie.OR])},$t=function(n){return!!n[ve.PATH]},Ct=function(n){return!K(n)&&Le(n)&&!ye(n)},Ne=function(n){return l({},ie.AND,Object.keys(n).map(function(e){return l({},e,n[e])}))};function Fe(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.auto,a=r===void 0?!0:r,o=function d(h){var g=Object.keys(h),b=$t(h);if(!b&&g.length>1&&!ye(h))return d(Ne(h));if(Ct(h)){var m=b?h[ve.PATH]:g[0],M=b?h[ve.PATTERN]:h[m];if(!H(M))throw new Error(tt(m));var k={keyId:fe(m),pattern:M};return a&&(k.searcher=me(M,n)),k}var w={children:[],operator:g[0]};return g.forEach(function(S){var $=h[S];K($)&&$.forEach(function(A){w.children.push(d(A))})}),w};return ye(t)||(t=Ne(t)),o(t)}function Et(t,n){var e=n.ignoreFieldNorm,r=e===void 0?_.ignoreFieldNorm:e;t.forEach(function(a){var o=1;a.matches.forEach(function(d){var h=d.key,g=d.norm,b=d.score,m=h?h.weight:null;o*=Math.pow(b===0&&m?Number.EPSILON:b,(m||1)*(r?1:g))}),a.score=o})}function Rt(t,n){var e=t.matches;n.matches=[],D(e)&&e.forEach(function(r){if(!(!D(r.indices)||!r.indices.length)){var a=r.indices,o=r.value,d={indices:a,value:o};r.key&&(d.key=r.key.src),r.idx>-1&&(d.refIndex=r.idx),n.matches.push(d)}})}function Ot(t,n){n.score=t.score}function Pt(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.includeMatches,a=r===void 0?_.includeMatches:r,o=e.includeScore,d=o===void 0?_.includeScore:o,h=[];return a&&h.push(Rt),d&&h.push(Ot),t.map(function(g){var b=g.idx,m={item:n[b],refIndex:b};return h.length&&h.forEach(function(M){M(g,m)}),m})}var X=(function(){function t(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;u(this,t),this.options=i(i({},_),e),this.options.useExtendedSearch,this._keyStore=new st(this.options.keys),this.setCollection(n,r)}return f(t,[{key:"setCollection",value:function(e,r){if(this._docs=e,r&&!(r instanceof ge))throw new Error(et);this._myIndex=r||Ce(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}},{key:"add",value:function(e){D(e)&&(this._docs.push(e),this._myIndex.add(e))}},{key:"remove",value:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){return!1},r=[],a=0,o=this._docs.length;a<o;a+=1){var d=this._docs[a];e(d,a)&&(this.removeAt(a),a-=1,o-=1,r.push(d))}return r}},{key:"removeAt",value:function(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.limit,o=a===void 0?-1:a,d=this.options,h=d.includeMatches,g=d.includeScore,b=d.shouldSort,m=d.sortFn,M=d.ignoreFieldNorm,k=H(e)?H(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Et(k,{ignoreFieldNorm:M}),b&&k.sort(m),we(o)&&o>-1&&(k=k.slice(0,o)),Pt(k,this._docs,{includeMatches:h,includeScore:g})}},{key:"_searchStringList",value:function(e){var r=me(e,this.options),a=this._myIndex.records,o=[];return a.forEach(function(d){var h=d.v,g=d.i,b=d.n;if(D(h)){var m=r.searchIn(h),M=m.isMatch,k=m.score,w=m.indices;M&&o.push({item:h,idx:g,matches:[{score:k,value:h,norm:b,indices:w}]})}}),o}},{key:"_searchLogical",value:function(e){var r=this,a=Fe(e,this.options),o=function b(m,M,k){if(!m.children){var w=m.keyId,S=m.searcher,$=r._findMatches({key:r._keyStore.get(w),value:r._myIndex.getValueForItemAtKeyId(M,w),searcher:S});return $&&$.length?[{idx:k,item:M,matches:$}]:[]}for(var A=[],E=0,P=m.children.length;E<P;E+=1){var N=m.children[E],R=b(N,M,k);if(R.length)A.push.apply(A,F(R));else if(m.operator===ie.AND)return[]}return A},d=this._myIndex.records,h={},g=[];return d.forEach(function(b){var m=b.$,M=b.i;if(D(m)){var k=o(a,m,M);k.length&&(h[M]||(h[M]={idx:M,item:m,matches:[]},g.push(h[M])),k.forEach(function(w){var S,$=w.matches;(S=h[M].matches).push.apply(S,F($))}))}}),g}},{key:"_searchObjectList",value:function(e){var r=this,a=me(e,this.options),o=this._myIndex,d=o.keys,h=o.records,g=[];return h.forEach(function(b){var m=b.$,M=b.i;if(D(m)){var k=[];d.forEach(function(w,S){k.push.apply(k,F(r._findMatches({key:w,value:m[S],searcher:a})))}),k.length&&g.push({idx:M,item:m,matches:k})}}),g}},{key:"_findMatches",value:function(e){var r=e.key,a=e.value,o=e.searcher;if(!D(a))return[];var d=[];if(K(a))a.forEach(function(w){var S=w.v,$=w.i,A=w.n;if(D(S)){var E=o.searchIn(S),P=E.isMatch,N=E.score,R=E.indices;P&&d.push({score:N,key:r,value:S,idx:$,norm:A,indices:R})}});else{var h=a.v,g=a.n,b=o.searchIn(h),m=b.isMatch,M=b.score,k=b.indices;m&&d.push({score:M,key:r,value:h,norm:g,indices:k})}return d}}]),t})();X.version="7.0.0",X.createIndex=Ce,X.parseIndex=ft,X.config=_,X.parseQuery=Fe,At(It);var Tt=X;return Tt}))});var Qt={};Ut(Qt,{AssistantController:()=>ue,AssistantEngine:()=>te});var Ke=Gt(ze()),te=class{constructor(i,s=Ke.default,u={}){this.searchData=i,this.Fuse=s,this.config={phoneticMap:{},semanticMap:{},stopWords:[],entityDefinitions:{},intentRules:[],...u},this.history={lastCategory:null,detectedEntities:new Set},this.initFuse()}initFuse(){this.Fuse&&(this.fuse=new this.Fuse(this.searchData,{keys:[{name:"title",weight:.8},{name:"keywords",weight:.5},{name:"description",weight:.2}],threshold:.45,includeScore:!0,useExtendedSearch:!0}))}autoCorrect(i){if(!this.config.phoneticMap)return i;for(let[s,u]of Object.entries(this.config.phoneticMap))if(u.includes(i))return s;return i}preprocess(i){let s={isQuestion:i.includes("?"),isUrgent:i.includes("!")},u=new Set(this.config.stopWords||[]),l=i.toLowerCase().replace(/[^\w\s]/g,"").split(/\s+/).filter(y=>y.length>1).map(y=>this.autoCorrect(y)),v=l.map(y=>this.stemIndonesian(y)),x=[...new Set([...l,...v])].filter(y=>!u.has(y)),I=[];return x.forEach(y=>{this.config.semanticMap&&this.config.semanticMap[y]&&I.push(...this.config.semanticMap[y]);let L=this.stemIndonesian(y);L!==y&&this.config.semanticMap&&this.config.semanticMap[L]&&I.push(...this.config.semanticMap[L])}),{tokens:x,expanded:[...new Set([...x,...I])],entities:this.extractEntities(x),signals:s}}extractEntities(i){let s={};if(this.config.entityDefinitions)for(let[u,c]of Object.entries(this.config.entityDefinitions)){let f=i.some(l=>c.includes(l));s[u]=f,f&&this.history.detectedEntities.add(u)}return s}async search(i){if(this.config.searchMode==="remote"&&this.config.apiUrl)try{let x=Array.isArray(this.config.apiUrl)?this.config.apiUrl:[this.config.apiUrl],y=(await Promise.all(x.map(async L=>{try{return await(await fetch(`${L}?q=${encodeURIComponent(i)}`,{headers:this.config.apiHeaders||{}})).json()}catch(C){return console.error(`Remote fetch failed for ${L}:`,C),{results:[],intent:"fuzzy",entities:{}}}}))).reduce((L,C)=>(L.results.push(...C.results||[]),C.intent&&C.intent!=="fuzzy"&&(L.intent=C.intent),L.entities={...L.entities,...C.entities||{}},L),{results:[],intent:"fuzzy",entities:{},confidence:0});if(y.results.length>0){let L=this.preprocess(i),C=y.results.map(F=>({item:F,score:this.calculateScore(F,L,.5)})).sort((F,J)=>J.score-F.score);return{...y,results:C.map(F=>F.item).slice(0,5),confidence:Math.min(Math.round(C[0].score*2),100)}}}catch(x){console.error("Remote search orchestration failed, falling back to local:",x)}let s=this.preprocess(i),u=[];this.fuse&&(u=this.fuse.search(s.expanded.join(" | ")).map(I=>({item:I.item,fuseScore:I.score})));let c=u.map(x=>{let I=this.calculateScore(x.item,s,x.fuseScore);return{item:x.item,score:I}});c.sort((x,I)=>I.score-x.score),c.length>0&&(this.history.lastCategory=c[0].item.category);let f=this.detectIntent(s),l=f.startsWith("chat_"),v="";f==="chat_greeting"?v=this.config.fallbackIntentResponses?.chat_greeting||"Halo! Ada yang bisa saya bantu hari ini? Anda bisa tanya tentang produk, harga, atau promo kami.":f==="chat_thanks"&&(v=this.config.fallbackIntentResponses?.chat_thanks||"Sama-sama! Senang bisa membantu. Ada lagi yang ingin ditanyakan?");let p=c.filter(x=>x.score>10||l&&x.score>5).map(x=>x.item).slice(0,5);return{results:p,intent:f,entities:s.entities,confidence:c.length>0?Math.min(Math.round(c[0].score*2),100):l?80:0,answer:v||p[0]?.answer||""}}calculateDiceCoefficient(i,s){let u=v=>{let p=new Set;for(let x=0;x<v.length-1;x++)p.add(v.substring(x,x+2));return p};if(i===s)return 1;if(i.length<2||s.length<2)return 0;let c=u(i),f=u(s),l=0;for(let v of c)f.has(v)&&l++;return 2*l/(c.size+f.size)}stemIndonesian(i){let s=i.toLowerCase(),u=["lah","kah","pun","ku","mu","nya"];for(let l of u)if(s.endsWith(l)&&s.length>l.length+3){s=s.slice(0,-l.length);break}let c=["kan","an","i"];for(let l of c)if(s.endsWith(l)&&s.length>l.length+3){if(l==="i"&&s.endsWith("ti"))continue;s=s.slice(0,-l.length);break}let f=["memper","pember","penge","peng","peny","pen","pem","per","pe","ber","be","ter","te","me","di","ke","se"];for(let l of f)if(s.startsWith(l)&&s.length>l.length+3){l==="mem"&&"aiueo".includes(s[3])?s="p"+s.slice(3):l==="men"&&"aiueo".includes(s[3])?s="t"+s.slice(3):l==="meng"&&"aiueo".includes(s[4])?s="k"+s.slice(4):l==="meny"&&"aiueo".includes(s[4])?s="s"+s.slice(4):s=s.slice(l.length);break}return s}calculateScore(i,s,u){let c=(1-u)*10,f=i.title.toLowerCase(),l=i.description.toLowerCase(),v=(i.keywords||[]).map(y=>y.toLowerCase()),p=f+" "+v.join(" ")+" "+l;s.tokens.forEach((y,L)=>{p.includes(y)&&(c+=10,L>0&&p.includes(s.tokens[L-1]+" "+y)&&(c+=8));let C=this.calculateDiceCoefficient(y,f);C>.4&&(c+=C*15)}),s.tokens.forEach(y=>{f.includes(y)&&(c+=20),i.category.toLowerCase().includes(y)&&(c+=25),v.includes(y)&&(c+=15)});let x=this.calculateDiceCoefficient(s.tokens.join(""),f.replace(/\s/g,""));return x>.3&&(c+=x*40),this.history.lastCategory===i.category&&(c+=10),i.is_recommended&&(c+=25),s.signals?.isQuestion&&(i.answer&&(c+=15),(i.category.toLowerCase().includes("layanan")||i.category.toLowerCase().includes("syarat"))&&(c+=5)),s.signals?.isUrgent&&(c+=10),this.detectIntent(s).startsWith("sales_")&&((i.price_numeric||i.sale_price)&&(c+=30),i.badge_text&&(c+=15),(i.category.toLowerCase().includes("produk")||i.category.toLowerCase().includes("layanan"))&&(c+=20)),c}detectIntent(i){let u={...{beli:["beli","pesan","ambil","order","checkout","booking","buy","purchase","get"],harga:["harga","biaya","price","budget","bayar","cicilan","dp","murah","cost","payment","cheap"],promo:["promo","diskon","discount","sale","hemat","bonus","voucher","off"]},...this.config.salesTriggers||{}},c=i.tokens.map(v=>this.stemIndonesian(v));for(let[v,p]of Object.entries(u))if(p.some(x=>c.includes(x)||i.tokens.includes(x)))return`sales_${v}`;let l={...{greeting:["halo","halo","hi","helo","hey","pagi","siang","sore","malam","assalamualaikum","permisi","hello"],thanks:["terima kasih","thanks","tq","syukron","makasih","oke","sip","mantap"]},...this.config.conversationTriggers||{}};for(let[v,p]of Object.entries(l))if(p.some(x=>c.includes(x)||i.tokens.includes(x)))return`chat_${v}`;if(!this.config.intentRules)return"fuzzy";for(let v of this.config.intentRules){let p=!v.conditions.entities||v.conditions.entities.some(I=>i.entities[I]),x=!v.conditions.tokens||v.conditions.tokens.some(I=>i.tokens.includes(I)||c.includes(I));if(p&&x)return v.intent}return"fuzzy"}getComparisonTriggers(){let i=["bandingkan","banding","perbandingan","beda","perbedaan","lebih bagus","lebih baik","mana yang","pilih mana","vs","versus","dibanding","ketimbang","daripada","compare","comparison","difference","which is better","versus","vs","differ","choose between","better than","compared to"];return this.config.comparisonTriggers||i}getComparisonLabels(){return{...{title:"Produk",price:"Harga",recommendation:"\u{1F3C6} Rekomendasi",bestChoice:"Pilihan Terbaik",reasons:"Alasan",noProducts:"Tidak ada produk untuk dibandingkan.",vsLabel:"vs"},...this.config.comparisonLabels||{}}}isComparisonQuery(i){let s=this.getComparisonTriggers(),u=i.toLowerCase();return s.some(c=>u.includes(c))}extractAttributes(i){let s={},u=(i.description||"").toLowerCase(),f=`${(i.title||"").toLowerCase()} ${u}`,v={...{harga:/(?:harga|price|biaya)[:\s]*(?:rp\.?|idr)?\s*([\d.,]+)/i,kapasitas:/(?:kapasitas|capacity)[:\s]*([\d.,]+\s*(?:gb|mb|tb|liter|kg|gram|ml|l|g))/i,kecepatan:/(?:kecepatan|speed)[:\s]*([\d.,]+\s*(?:mbps|gbps|rpm|mhz|ghz))/i,garansi:/(?:garansi|warranty)[:\s]*([\d]+\s*(?:tahun|bulan|year|month|hari|day)s?)/i,rating:/(?:rating|bintang|star)[:\s]*([\d.,]+)/i,material:/(?:bahan|material)[:\s]*([a-zA-Z\s]+?)(?:\.|,|$)/i,warna:/(?:warna|color|colour)[:\s]*([a-zA-Z\s]+?)(?:\.|,|$)/i,ukuran:/(?:ukuran|size|dimensi|dimension)[:\s]*([\d.,x\s]+(?:cm|mm|m|inch)?)/i}};if(this.config.attributeExtractors)for(let[I,y]of Object.entries(this.config.attributeExtractors))v[I]=typeof y=="string"?new RegExp(y,"i"):y;for(let[I,y]of Object.entries(v)){let L=f.match(y);L&&L[1]&&(s[I]=L[1].trim())}i.price_numeric&&(s.harga=i.price_numeric),i.sale_price&&(s.harga_promo=i.sale_price),i.badge_text&&(s.badge=i.badge_text),i.is_recommended&&(s.direkomendasikan=!0);let p=[/(?:fitur|feature|keunggulan|kelebihan)[:\s]*([^.]+)/gi,/(?:•|▪|★|✓|✔|-)([^•▪★✓✔\-\n]+)/g],x=[];for(let I of p){let y;for(;(y=I.exec(f))!==null;){let L=y[1].trim();L.length>3&&L.length<100&&x.push(L)}}return x.length>0&&(s.fitur=x.slice(0,5).join("; ")),s}calculateComparisonScore(i,s){let u=0;if(i.sale_price&&i.price_numeric){let f=(i.price_numeric-i.sale_price)/i.price_numeric*100;u+=Math.min(f,50)}if(i.is_recommended&&(u+=30),i.badge_text){let f=i.badge_text.toLowerCase();(f.includes("best")||f.includes("terbaik"))&&(u+=25),(f.includes("popular")||f.includes("populer"))&&(u+=20),(f.includes("new")||f.includes("baru"))&&(u+=15),(f.includes("sale")||f.includes("promo"))&&(u+=15)}let c=Object.keys(s).length;if(u+=Math.min(c*5,25),s.rating){let f=parseFloat(String(s.rating));isNaN(f)||(u+=f*5)}if(s.garansi){let f=String(s.garansi).match(/(\d+)/);if(f){let l=parseInt(f[1]);u+=Math.min(l*10,30)}}return u}generateReasons(i,s){let u=[],c=this.getComparisonLabels();if(i.salePrice&&i.price){let p=Math.round((i.price-i.salePrice)/i.price*100);u.push(`Diskon ${p}% dari harga normal`)}let f=s.filter(p=>p.price||p.salePrice).map(p=>p.salePrice||p.price||1/0);(i.salePrice||i.price||1/0)===Math.min(...f)&&f.length>1&&u.push("Harga paling terjangkau");let v=s.map(p=>Object.keys(p.attributes).length);return Object.keys(i.attributes).length===Math.max(...v)&&v.length>1&&u.push("Fitur paling lengkap"),i.attributes.garansi&&u.push(`Garansi: ${i.attributes.garansi}`),i.isRecommended&&u.push("Direkomendasikan oleh tim kami"),u.slice(0,4)}generateTableHtml(i,s){let u=this.getComparisonLabels();if(i.length===0)return`<p>${u.noProducts}</p>`;let c='<table class="comparison-table" style="width:100%;border-collapse:collapse;font-size:14px;">';c+='<thead><tr style="background:#f5f5f5;">',c+=`<th style="padding:12px;border:1px solid #ddd;text-align:left;">${u.title}</th>`;for(let l of i){let v=l.isRecommended?" \u2B50":"";c+=`<th style="padding:12px;border:1px solid #ddd;text-align:center;">${l.title}${v}</th>`}if(c+="</tr></thead>",c+="<tbody>",i.some(l=>l.price||l.salePrice)){c+="<tr>",c+=`<td style="padding:10px;border:1px solid #ddd;font-weight:bold;">${u.price}</td>`;for(let l of i){let v="-";l.salePrice&&l.price&&l.salePrice<l.price?v=`<span style="text-decoration:line-through;color:#999;">Rp ${l.price.toLocaleString("id-ID")}</span><br><span style="color:#e53935;font-weight:bold;">Rp ${l.salePrice.toLocaleString("id-ID")}</span>`:l.price?v=`Rp ${l.price.toLocaleString("id-ID")}`:l.salePrice&&(v=`<span style="color:#e53935;font-weight:bold;">Rp ${l.salePrice.toLocaleString("id-ID")}</span>`),c+=`<td style="padding:10px;border:1px solid #ddd;text-align:center;">${v}</td>`}c+="</tr>"}for(let l of s)if(!(l==="harga"||l==="harga_promo")){c+="<tr>",c+=`<td style="padding:10px;border:1px solid #ddd;font-weight:bold;">${this.formatAttributeLabel(l)}</td>`;for(let v of i){let p=v.attributes[l],x="-";p!=null&&(typeof p=="boolean"?x=p?"\u2713":"\u2717":x=String(p)),c+=`<td style="padding:10px;border:1px solid #ddd;text-align:center;">${x}</td>`}c+="</tr>"}return c+="</tbody></table>",c}generateTableMarkdown(i,s){let u=this.getComparisonLabels();if(i.length===0)return u.noProducts;let c="";c+=`| ${u.title} |`;for(let l of i){let v=l.isRecommended?" \u2B50":"";c+=` ${l.title}${v} |`}c+=`
`,c+="|---|";for(let l=0;l<i.length;l++)c+="---|";if(c+=`
`,i.some(l=>l.price||l.salePrice)){c+=`| **${u.price}** |`;for(let l of i)l.salePrice&&l.price&&l.salePrice<l.price?c+=` ~~Rp ${l.price.toLocaleString("id-ID")}~~ **Rp ${l.salePrice.toLocaleString("id-ID")}** |`:l.price?c+=` Rp ${l.price.toLocaleString("id-ID")} |`:l.salePrice?c+=` **Rp ${l.salePrice.toLocaleString("id-ID")}** |`:c+=" - |";c+=`
`}for(let l of s)if(!(l==="harga"||l==="harga_promo")){c+=`| **${this.formatAttributeLabel(l)}** |`;for(let v of i){let p=v.attributes[l],x="-";p!=null&&(typeof p=="boolean"?x=p?"\u2713":"\u2717":x=String(p)),c+=` ${x} |`}c+=`
`}return c}formatAttributeLabel(i){return{harga:"Harga",harga_promo:"Harga Promo",kapasitas:"Kapasitas",kecepatan:"Kecepatan",garansi:"Garansi",rating:"Rating",material:"Material",warna:"Warna",ukuran:"Ukuran",fitur:"Fitur",badge:"Badge",direkomendasikan:"Rekomendasi"}[i]||i.charAt(0).toUpperCase()+i.slice(1)}async compareProducts(i,s,u=4){let c=[];if(s?c=this.searchData.filter(y=>y.category.toLowerCase().includes(s.toLowerCase())):c=(await this.search(i)).results,c.length===0){let y=this.preprocess(i);for(let L of this.searchData){let C=L.title.toLowerCase(),F=L.category.toLowerCase();y.tokens.some(J=>C.includes(J)||F.includes(J))&&c.push(L)}}c=c.slice(0,u);let f=c.map(y=>{let L=this.extractAttributes(y),C=this.calculateComparisonScore(y,L);return{title:y.title,attributes:L,score:C,isRecommended:y.is_recommended||!1,url:y.url,price:y.price_numeric,salePrice:y.sale_price}});f.sort((y,L)=>L.score-y.score);let l=new Set;for(let y of f)for(let L of Object.keys(y.attributes))l.add(L);let v=Array.from(l),p=null;if(f.length>0){let y=f[0],L=this.generateReasons(y,f);p={item:y,reasons:L}}let x=this.generateTableHtml(f,v),I=this.generateTableMarkdown(f,v);return{items:f,attributeLabels:v,recommendation:p,tableHtml:x,tableMarkdown:I}}async searchWithComparison(i){let s=await this.search(i);if(this.isComparisonQuery(i)){let u=await this.compareProducts(i),c=this.getComparisonLabels(),f="";if(u.recommendation){if(f=`${c.recommendation}: **${u.recommendation.item.title}**

`,u.recommendation.reasons.length>0){f+=`${c.reasons}:
`;for(let l of u.recommendation.reasons)f+=`\u2022 ${l}
`}f+=`
${u.tableMarkdown}`}else f=c.noProducts;return{...s,intent:"comparison",answer:f,comparison:u}}return s}};var ue=class{constructor(i,s=void 0,u={},c={}){this.elements={};this.chatHistory=[];this.interactionCount=0;this.engine=new te(i,s,c),this.selectors=u,this.config=c,this.initElements(),this.initEventListeners(),this.loadHistory()}initElements(){this.elements.overlay=document.getElementById(this.selectors.overlayId),this.elements.input=document.getElementById(this.selectors.inputId),this.elements.sendBtn=document.getElementById(this.selectors.sendBtnId),this.elements.closeBtn=document.getElementById(this.selectors.closeBtnId),this.elements.chatContainer=document.getElementById(this.selectors.chatContainerId),this.elements.messagesList=document.getElementById(this.selectors.messagesListId),this.elements.typingIndicator=document.getElementById(this.selectors.typingIndicatorId),this.elements.welcomeMsg=document.querySelector(`.${this.selectors.welcomeMsgClass}`)}initEventListeners(){let i=this.elements.input;i&&i.addEventListener("keydown",s=>{s.key==="Enter"&&this.performAction()}),this.elements.sendBtn&&this.elements.sendBtn.addEventListener("click",()=>this.performAction()),this.elements.closeBtn&&this.elements.closeBtn.addEventListener("click",()=>this.closeAssistant()),document.querySelectorAll(`.${this.selectors.quickLinksClass}`).forEach(s=>{let u=s;u.addEventListener("click",()=>{i&&u.dataset.query&&(i.value=u.dataset.query,this.performAction())})}),document.addEventListener("keydown",s=>{s.key==="Escape"&&this.elements.overlay&&!this.elements.overlay.classList.contains("hidden")&&this.closeAssistant(),(s.metaKey||s.ctrlKey)&&s.key==="k"&&(s.preventDefault(),this.openAssistant())}),this.elements.overlay&&this.elements.overlay.addEventListener("click",s=>{s.target===this.elements.overlay&&this.closeAssistant()})}openAssistant(){let i=this.elements.overlay,s=this.elements.input;!i||!s||(i.classList.remove("hidden"),setTimeout(()=>{i.classList.remove("opacity-0"),s.focus(),this.elements.welcomeMsg&&this.elements.welcomeMsg.classList.remove("opacity-0","translate-y-4")},10),document.body.style.overflow="hidden")}closeAssistant(){let i=this.elements.overlay,s=this.elements.input;!i||!s||(i.classList.add("opacity-0"),setTimeout(()=>{i.classList.add("hidden"),s.value=""},300),document.body.style.overflow="")}performAction(){let i=this.elements.input;if(!i)return;let s=i.value;s.trim()&&(i.value="",this.addUserMessage(s),this.showTyping(),setTimeout(async()=>{this.hideTyping();let u=await this.engine.search(s);this.addAssistantMessage(s,u)},1e3))}showTyping(){let i=this.elements.typingIndicator;i&&(i.classList.remove("hidden"),setTimeout(()=>i.classList.remove("opacity-0"),10),this.scrollToBottom())}hideTyping(){let i=this.elements.typingIndicator;i&&(i.classList.add("opacity-0"),setTimeout(()=>i.classList.add("hidden"),300))}scrollToBottom(){let i=this.elements.chatContainer;i&&i.scrollTo({top:i.scrollHeight,behavior:"smooth"})}addUserMessage(i,s=!0){if(!this.elements.messagesList)return;let u=document.createElement("div");u.className="bubble-container user opacity-0 translate-y-4 bubble-user",u.innerHTML=`
            <div class="bg-gradient-to-br from-primary to-primary-dark text-white p-5 rounded-3xl rounded-tr-none shadow-xl max-w-[85%] border border-white/10">
                <p class="text-sm md:text-base font-semibold tracking-tight">${i}</p>
            </div>`,this.elements.messagesList.appendChild(u),s&&(this.chatHistory.push({type:"user",text:i}),this.saveHistory())}addAssistantMessage(i,s,u=!0){if(!this.elements.messagesList)return;this.interactionCount++,u&&(this.chatHistory.push({type:"assistant",text:i,result:s}),this.saveHistory());let c=document.createElement("div");c.className="bubble-container assistant opacity-0 translate-y-4 bubble-assistant";let f=this.generateResponseHTML(i,s);c.innerHTML=`
            <div class="w-11 h-11 rounded-2xl bg-white flex items-center justify-center text-primary shrink-0 shadow-lg border border-gray-100 hidden md:flex">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                </svg>
            </div>
            <div class="space-y-3 max-w-[92%] md:max-w-[85%]">
                <div class="bg-white/80 backdrop-blur-md p-6 rounded-3xl rounded-tl-none shadow-2xl border border-white/40 text-dark leading-relaxed">
                    ${f}
                </div>
            </div>`,this.elements.messagesList.appendChild(c),this.scrollToBottom()}generateResponseHTML(i,s){let{results:u,confidence:c,answer:f}=s,l="";if(f)l+=`<p class="text-sm md:text-base font-medium mb-4">${this.formatText(f)}</p>`;else if(u.length>0){let v=u[0];l+=`<p class="text-sm md:text-base font-medium mb-4">${this.formatText(v.answer||v.description)}</p>`}if(u.length>0){let v=u.filter(p=>p.category!=="Sapaan").slice(0,3).map((p,x)=>{let I=x===0&&(p.price_numeric||p.sale_price||p.is_recommended),y=p.cta_label||(p.category.includes("Produk")||p.category.includes("Layanan")?"Pesan Sekarang":"Lihat Detail");return`
                <a href="${p.cta_url||p.url}" class="flex flex-col gap-3 p-5 ${I?"bg-primary/5 border-primary/40 shadow-lg ring-1 ring-primary/20":"bg-white/50 border-gray-100"} hover:bg-white hover:scale-[1.02] hover:shadow-2xl rounded-3xl border transition-all group w-full mb-3">
                    <div class="flex items-center justify-between">
                        <div class="flex flex-wrap gap-2">
                            <span class="text-[9px] font-black text-white bg-primary px-2 py-1 rounded-lg uppercase tracking-wider">${p.category}</span>
                            ${p.badge_text?`<span class="text-[9px] font-bold text-white bg-red-500 px-2 py-1 rounded-lg uppercase tracking-wider">${p.badge_text}</span>`:""}
                            ${p.is_recommended?'<span class="text-[9px] font-bold text-white bg-orange-500 px-2 py-1 rounded-lg uppercase tracking-wider animate-pulse">\u2728 Unggulan</span>':""}
                        </div>
                        ${p.price_numeric?`
                            <div class="text-right">
                                ${p.sale_price?`<span class="text-[10px] text-gray-400 line-through block">Rp ${(p.price_numeric/1e6).toFixed(1)}Jt</span>`:""}
                                <span class="text-sm font-extrabold text-primary">Rp ${((p.sale_price||p.price_numeric)/1e6).toFixed(1)}Jt</span>
                            </div>
                        `:""}
                    </div>
                    <h4 class="font-extrabold text-dark text-base leading-tight group-hover:text-primary transition-colors">${p.title}</h4>
                    <p class="text-[12px] text-gray-500 line-clamp-2 leading-relaxed">${p.description}</p>
                    <div class="flex items-center justify-end mt-2 pt-2 border-t border-gray-50">
                        <span class="bg-primary/10 text-primary px-3 py-1.5 rounded-xl text-[10px] font-bold flex items-center gap-1.5 group-hover:bg-primary group-hover:text-white transition-all">
                            ${y}
                            <svg class="w-2.5 h-2.5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"></path></svg>
                        </span>
                    </div>
                </a>`}).join("");v&&(l+=`<div class="mt-4">${v}</div>`)}else f||(l='<p class="flex items-center gap-2 text-gray-400 italic text-sm"><svg class="w-4 h-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> Maaf, saya belum menemukan jawaban yang pas. Silakan hubungi admin kami via WhatsApp.</p>',this.config.whatsappNumber&&setTimeout(()=>{let v=`https://wa.me/${this.config.whatsappNumber}?text=${encodeURIComponent("Halo, saya ingin bertanya tentang: "+i)}`;window.open(v,"_blank")},2e3));return l}formatText(i){return i.replace(/\*\*(.*?)\*\*/g,'<span class="font-bold text-primary">$1</span>')}saveHistory(){localStorage.setItem("assistant_chat_history",JSON.stringify(this.chatHistory))}loadHistory(){let i=localStorage.getItem("assistant_chat_history");if(i)try{this.chatHistory=JSON.parse(i),this.chatHistory.forEach(s=>{s.type==="user"?this.addUserMessage(s.text,!1):s.type==="assistant"&&s.result&&this.addAssistantMessage(s.text,s.result,!1)})}catch(s){console.error("History load error",s)}}};return Vt(Qt);})();
